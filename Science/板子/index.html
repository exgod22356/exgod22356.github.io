<!doctype html>
<html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><title>板子 - Icarus</title><link rel="manifest" href="/manifest.json"><meta name="theme-color" content="#f7f7f7"><meta name="application-name" content="Icaurs - Hexo Theme"><meta name="msapplication-TileImage" content="/img/favicon.svg"><meta name="msapplication-TileColor" content="#f7f7f7"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-title" content="Icaurs - Hexo Theme"><meta name="apple-mobile-web-app-status-bar-style" content="default"><meta name="description" content="板子"><meta property="og:type" content="blog"><meta property="og:title" content="板子"><meta property="og:url" content="https://exgod22356.github.com/Science/%E6%9D%BF%E5%AD%90/"><meta property="og:site_name" content="Icarus"><meta property="og:description" content="板子"><meta property="og:locale" content="en_US"><meta property="og:image" content="https://exgod22356.github.com/gallery/banzi/mobius.png"><meta property="og:image" content="https://exgod22356.github.com/gallery/banzi/mobius1.png"><meta property="og:image" content="https://exgod22356.github.com/gallery/banzi/1.jpg"><meta property="og:image" content="https://exgod22356.github.com/gallery/banzi/2.jpg"><meta property="og:image" content="https://exgod22356.github.com/gallery/banzi/3.jpg"><meta property="og:image" content="https://exgod22356.github.com/gallery/banzi/4.jpg"><meta property="og:image" content="https://exgod22356.github.com/gallery/banzi/5.jpg"><meta property="og:image" content="https://exgod22356.github.com/gallery/banzi/6.jpg"><meta property="og:image" content="https://exgod22356.github.com/gallery/banzi/7.jpg"><meta property="og:image" content="https://exgod22356.github.com/gallery/banzi/8.jpg"><meta property="article:published_time" content="2019-08-27T18:10:30.000Z"><meta property="article:author" content="王钦砚"><meta property="article:tag" content="编程"><meta property="article:tag" content="ACM"><meta property="article:tag" content="模板"><meta property="twitter:card" content="summary"><meta property="twitter:image" content="/gallery/banzi/mobius.png"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://exgod22356.github.com/Science/%E6%9D%BF%E5%AD%90/"},"headline":"Icarus","image":["https://exgod22356.github.com/gallery/banzi/mobius.png","https://exgod22356.github.com/gallery/banzi/mobius1.png","https://exgod22356.github.com/gallery/banzi/1.jpg","https://exgod22356.github.com/gallery/banzi/2.jpg","https://exgod22356.github.com/gallery/banzi/3.jpg","https://exgod22356.github.com/gallery/banzi/4.jpg","https://exgod22356.github.com/gallery/banzi/5.jpg","https://exgod22356.github.com/gallery/banzi/6.jpg","https://exgod22356.github.com/gallery/banzi/7.jpg","https://exgod22356.github.com/gallery/banzi/8.jpg"],"datePublished":"2019-08-27T18:10:30.000Z","author":{"@type":"Person","name":"王钦砚"},"description":"板子"}</script><link rel="canonical" href="https://exgod22356.github.com/Science/%E6%9D%BF%E5%AD%90/"><link rel="icon" href="/img/favicon.svg"><link rel="stylesheet" href="https://cdn.bootcdn.net/ajax/libs/font-awesome/5.15.2/css/all.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@9.12.0/styles/atom-one-dark.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Ubuntu:wght@400;600&amp;family=Source+Code+Pro"><link rel="stylesheet" href="/css/default.css"><style>body>.footer,body>.navbar,body>.section{opacity:0}</style><!--!--><!--!--><!--!--><!--!--><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/cookieconsent@3.1.1/build/cookieconsent.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/css/lightgallery.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/css/justifiedGallery.min.css"><!--!--><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/outdatedbrowser@1.1.5/outdatedbrowser/outdatedbrowser.min.css"><script src="https://cdn.jsdelivr.net/npm/pace-js@1.0.2/pace.min.js"></script><!--!--><!--!--><meta name="generator" content="Hexo 5.3.0"></head><body class="is-2-column"><nav class="navbar navbar-main"><div class="container"><div class="navbar-brand justify-content-center"><a class="navbar-item navbar-logo" href="/"><img src="/img/logo.svg" alt="Icarus" height="28"></a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item" href="/">Home</a><a class="navbar-item" href="/archives">Archives</a><a class="navbar-item" href="/categories">Categories</a><a class="navbar-item" href="/tags">Tags</a><a class="navbar-item" href="/about">About</a></div><div class="navbar-end"><a class="navbar-item" target="_blank" rel="noopener" title="Gitter" href="https://gitter.im/"><i class="fab fa-gitter"></i></a><a class="navbar-item" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/exgod22356/exgod22356.github.io"><i class="fab fa-github"></i></a><a class="navbar-item is-hidden-tablet catalogue" title="Catalogue" href="javascript:;"><i class="fas fa-list-ul"></i></a><a class="navbar-item search" title="Search" href="javascript:;"><i class="fas fa-search"></i></a></div></div></div></nav><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-8-tablet is-8-desktop is-8-widescreen"><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time dateTime="2019-08-27T18:10:30.000Z" title="2019-08-27T18:10:30.000Z">2019-08-28</time></span><span class="level-item"><a class="link-muted" href="/categories/Science/">Science</a></span><span class="level-item">42 minutes read (About 6249 words)</span></div></div><h1 class="title is-3 is-size-4-mobile">板子</h1><div class="content"><p>板子</p>
<a id="more"></a>

    <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script>
    <script type="text/x-mathjax-config">
        MathJax.Hub.Config({
            tex2jax: {
            skipTags: ['script', 'noscript', 'style', 'textarea', 'pre'],
            inlineMath: [['$','$']]
            }
        });
    </script>
  


<h1 id="目录"><a href="#目录" class="headerlink" title="目录"></a>目录</h1><ul>
<li><a href="#1-%E6%95%B0%E5%AD%A6">1. 数学</a><ul>
<li><a href="#1-1-gcd">1.1. gcd</a></li>
<li><a href="#1-2-exgcd">1.2. exgcd</a></li>
<li><a href="#1-3-%E6%B1%82%E8%A7%A3%E7%BA%BF%E6%80%A7%E5%90%8C%E4%BD%99%E6%96%B9%E7%A8%8B">1.3. 求解线性同余方程</a></li>
<li><a href="#1-4-%E6%AC%A7%E6%8B%89%E5%AE%9A%E7%90%86%E6%89%A9%E5%B1%95-%E4%B8%8D%E9%80%82%E7%94%A8%E4%BA%8E%E7%9F%A9%E9%98%B5">1.4. 欧拉定理(扩展， 不适用于矩阵)</a></li>
<li><a href="#1-5-%E7%9F%A9%E9%98%B5">1.5. 矩阵</a></li>
<li><a href="#1-6-%E5%B9%BF%E4%B9%89%E6%96%90%E6%B3%A2%E9%82%A3%E5%A5%91%E6%95%B0%E5%88%97%E5%BE%AA%E7%8E%AF%E8%8A%82">1.6. 广义斐波那契数列循环节</a></li>
<li><a href="#1-7-%E6%95%B4%E9%99%A4%E5%88%86%E5%9D%97">1.7. 整除分块</a></li>
<li><a href="#1-8-%E8%8E%AB%E6%AF%94%E4%B9%8C%E6%96%AF%E5%8F%8D%E6%BC%94">1.8. 莫比乌斯反演</a></li>
<li><a href="#1-9-lucas">1.9. Lucas</a></li>
<li><a href="#1-10-%E9%80%86%E5%85%83">1.10. 逆元</a></li>
<li><a href="#1-11-bm%E7%AE%97%E6%B3%95">1.11. BM算法</a></li>
<li><a href="#1-12-%E4%BA%8C%E6%AC%A1%E5%89%A9%E4%BD%99">1.12. 二次剩余</a></li>
<li><a href="#1-13-k%E6%AC%A1%E5%B9%82%E5%92%8C">1.13. k次幂和</a></li>
<li><a href="#1-14-%E6%9D%9C%E6%95%99%E7%AD%9B">1.14. 杜教筛</a></li>
</ul>
</li>
<li><a href="#2-%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84">2. 数据结构</a><ul>
<li><a href="#2-1-kd%E6%A0%91">2.1. kd树</a></li>
</ul>
</li>
<li><a href="#3-dp">3. dp</a><ul>
<li><a href="#3-1-%E5%8C%BA%E9%97%B4dp">3.1. 区间dp</a></li>
<li><a href="#3-2-%E7%8A%B6%E5%8E%8Bdp">3.2. 状压dp</a></li>
<li><a href="#3-3-%E6%95%B0%E4%BD%8Ddp">3.3. 数位dp</a></li>
</ul>
</li>
<li><a href="#4-%E8%AE%A1%E7%AE%97%E5%87%A0%E4%BD%95">4. 计算几何</a><ul>
<li><a href="#4-1-%E7%BA%A2%E4%B9%A6">4.1. 红书</a></li>
<li><a href="#4-2-%E4%B8%89%E7%BB%B4%E5%90%91%E9%87%8F%E6%97%8B%E8%BD%AC">4.2. 三维向量旋转</a></li>
</ul>
</li>
<li><a href="#5-%E5%8D%9A%E5%BC%88">5. 博弈</a></li>
<li><a href="#6-%E5%9B%BE%E8%AE%BA">6. 图论</a></li>
<li><a href="#7-%E9%BB%91%E7%A7%91%E6%8A%80">7. 黑科技</a><ul>
<li><a href="#7-1-%E9%AB%98%E7%B2%BE">7.1. 高精</a></li>
</ul>
</li>
<li><a href="#8-tips">8. tips</a></li>
</ul>
<blockquote>
<p>该板子补充红书上没有或者替换成自己熟悉的板子</p>
</blockquote>
<h2 id="1-数学"><a href="#1-数学" class="headerlink" title="1. 数学"></a>1. 数学</h2><h3 id="1-1-gcd"><a href="#1-1-gcd" class="headerlink" title="1.1. gcd"></a>1.1. gcd</h3><blockquote>
<p>$gcd(a, b) = gcd(b, a % b)$ 等式(1)</p>
</blockquote>
<figure class="highlight cpp"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">ll <span class="title">gcd</span><span class="params">(ll a,ll b)</span></span>{</span><br><span class="line">    <span class="keyword">return</span> b?gcd(b,a%b):a;</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line">或者</span><br><span class="line"><span class="function"><span class="keyword">inline</span> ll <span class="title">gcd</span><span class="params">(ll a,ll b)</span></span>{</span><br><span class="line">    <span class="keyword">if</span>(!b) <span class="keyword">return</span> a;</span><br><span class="line">    <span class="keyword">while</span>(b^=a^=b^=a%=b);<span class="comment">//先做一次取模，然后交换两个元素</span></span><br><span class="line">    <span class="keyword">return</span> a;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<h3 id="1-2-exgcd"><a href="#1-2-exgcd" class="headerlink" title="1.2. exgcd"></a>1.2. exgcd</h3><blockquote>
<p>求解 $ax + by = c$的x的最小正整数解</p>
</blockquote>
<ul>
<li>首先求解$ax + by = gcd(a, b)$(2)</li>
<li>由等式(1)可得 $bx1 + a % b * y1 = gcd(b, a % b) = ay1 + b * (-\lfloor \frac{a}{b} \rfloor +x1) * y1$ (3)</li>
<li>联立等式(2), (3)得到 $x=y_1, y=-\lfloor \frac{a}{b} \rfloor +x1$</li>
<li>将所得式子不断递归至$b=0$, 返回最后结果</li>
</ul>
<figure class="highlight cpp"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">ll <span class="title">exgcd</span><span class="params">(ll a, ll b, ll &amp;x, ll &amp;y)</span></span></span><br><span class="line"><span class="function"></span>{</span><br><span class="line">    <span class="keyword">if</span>(b == <span class="number">0</span>)</span><br><span class="line">    {</span><br><span class="line">        x = <span class="number">1</span>, y = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">return</span> a;</span><br><span class="line">    }</span><br><span class="line">    ll d = exgcd(b, a % b, y, x);</span><br><span class="line">    y -= a / b * x;</span><br><span class="line">    <span class="keyword">return</span> d;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<ul>
<li>设$d=gcd(a, b)$, 等式两边则同时乘上$\frac{c}{d}$则可以获得一组特解 $x1=x0 * \frac{c}{d}，y1=y0 * \frac{c}{d}$</li>
<li>每次将x0减少x，y0则相应增加$\frac{ax}{b}$, 若需要保证y依然为正整数，则 $\frac{ax}{b}=\frac{a}{d}, x=\frac{b}{d}$</li>
<li>保证$0 &lt; x1 &lt; x$时，即可得到答案。</li>
<li>若$x &lt; 0$，则将x取绝对值</li>
<li>若$x0 &lt; 0$，则将x0加上x即可。</li>
</ul>
<figure class="highlight cpp"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">d = exgcd(a, b, x, y);</span><br><span class="line"><span class="keyword">if</span>(c% d== <span class="number">0</span>)</span><br><span class="line">{</span><br><span class="line">    x *= c / d;</span><br><span class="line">    t = b / d;</span><br><span class="line">    t = <span class="built_in">abs</span>(t);</span><br><span class="line">    x = (x % t + t) % t;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%d\n"</span>, x);</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<h3 id="1-3-求解线性同余方程"><a href="#1-3-求解线性同余方程" class="headerlink" title="1.3. 求解线性同余方程"></a>1.3. 求解线性同余方程</h3><ul>
<li>给出n个同余方程$N \equiv a_1\mod p_1, N \equiv a_n\mod p_n$</li>
<li>求x的最小正整数解, $p_i$不互质</li>
<li>显然可以化为 $k1 * p1+a1=k2 * p2+a2-&gt;k1 * p1+(-k2 * p2)=a2-a1$</li>
<li>设$a=p1, b=p2, x=k1, y=(-k2), c=a2-a1$方程可写为$ax+by=c$</li>
<li>则问题转变为上一个题目</li>
<li>那么将x化为原方程的最小正整数解，$x=(x * (\frac{c}{d})%(\frac{b}{d})+(\frac{b}{d}))%(\frac{b}{d})$</li>
<li>所以$N=a * (x+z * (\frac{b}{d}))+r1-&gt;N=(\frac{ab}{d}) * z+(a * x+r1)$</li>
<li>现在只有z是未知数，所以变成$N\equiv (a * x+r1) mod (\frac{ab}{d}))$的问题</li>
<li>继续合并同余方程即可</li>
</ul>
<figure class="highlight cpp"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">ll M[<span class="number">55</span>], A[<span class="number">55</span>];</span><br><span class="line"><span class="function">ll <span class="title">China</span><span class="params">(<span class="keyword">int</span> r)</span></span>{</span><br><span class="line">    ll dm, i, a, b, x, y, d;</span><br><span class="line">    ll c, c1, c2;</span><br><span class="line">    a=M[<span class="number">0</span>];</span><br><span class="line">    c1=A[<span class="number">0</span>];</span><br><span class="line">    <span class="keyword">for</span>(i = <span class="number">1</span>; i &lt; r; i++){</span><br><span class="line">        b = M[i];</span><br><span class="line">        c2 = A[i];</span><br><span class="line">        exgcd(a, b ,d, x, y);</span><br><span class="line">        c = c2 - c1;</span><br><span class="line">        <span class="keyword">if</span>(c % d)</span><br><span class="line">            <span class="keyword">return</span> <span class="number">-1</span>;<span class="comment">//c一定是d的倍数，如果不是，则肯定无解</span></span><br><span class="line">        dm = b / d;</span><br><span class="line">        x = ((x * (c / d)) % dm + dm) % dm;<span class="comment">//保证x为最小正数//c/dm是余数，系数扩大</span></span><br><span class="line">        c1 = a * x + c1;</span><br><span class="line">        a = a * dm;</span><br><span class="line">    }</span><br><span class="line">    <span class="keyword">if</span>(c1 == <span class="number">0</span>){<span class="comment">//余数为0，说明M[]是等比数列。且余数都为0</span></span><br><span class="line">    c1 = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; r; i++)</span><br><span class="line">        c1 = c1 * M[i] / gcd(c1, M[i]);</span><br><span class="line">    }</span><br><span class="line">    <span class="keyword">return</span> c1;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<ul>
<li>中国剩余定理</li>
</ul>
<figure class="highlight cpp"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//n个方程：x=a[i](mod m[i]) (0&lt;=i&lt;n)</span></span><br><span class="line"><span class="function">LL <span class="title">china</span><span class="params">(<span class="keyword">int</span> n, LL *a, LL *m)</span></span>{</span><br><span class="line">    LL M = <span class="number">1</span>, ret = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i ++) M *= m[i];</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i ++){</span><br><span class="line">        LL w = M / m[i];</span><br><span class="line">        ret = (ret + w * inv(w, m[i]) * a[i]) % M;</span><br><span class="line">    }</span><br><span class="line">    <span class="keyword">return</span> (ret + M) % M;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<ul>
<li>进阶: 给出k个模方程组：x mod ai = ri。求x的最小正值。如果不存在这样的x，那么输出-1.</li>
</ul>
<figure class="highlight cpp"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> LL;</span><br><span class="line"><span class="keyword">typedef</span> <span class="built_in">pair</span>&lt;LL, LL&gt; PLL;</span><br><span class="line">LL a[<span class="number">100000</span>], b[<span class="number">100000</span>], m[<span class="number">100000</span>];</span><br><span class="line"><span class="function">LL <span class="title">gcd</span><span class="params">(LL a, LL b)</span></span>{</span><br><span class="line">    <span class="keyword">return</span> b ? gcd(b, a%b) : a;</span><br><span class="line">}</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">ex_gcd</span><span class="params">(LL a, LL b, LL &amp;x, LL &amp;y, LL &amp;d)</span></span>{</span><br><span class="line">    <span class="keyword">if</span> (!b) {d = a, x = <span class="number">1</span>, y = <span class="number">0</span>;}</span><br><span class="line">    <span class="keyword">else</span>{</span><br><span class="line">        ex_gcd(b, a % b, y, x, d);</span><br><span class="line">        y -= x * (a / b);</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"><span class="function">LL <span class="title">inv</span><span class="params">(LL t, LL p)</span></span>{<span class="comment">//如果不存在，返回-1</span></span><br><span class="line">    LL d, x, y;</span><br><span class="line">    ex_gcd(t, p, x, y, d);</span><br><span class="line">    <span class="keyword">return</span> d == <span class="number">1</span> ? (x % p + p) % p : <span class="number">-1</span>;</span><br><span class="line">}</span><br><span class="line"><span class="function">PLL <span class="title">linear</span><span class="params">(LL A[], LL B[], LL M[], <span class="keyword">int</span> n)</span> </span>{<span class="comment">//求解A[i]x = B[i] (mod M[i]),总共n个线性方程组</span></span><br><span class="line">    LL x = <span class="number">0</span>, m = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i ++) {</span><br><span class="line">        LL a = A[i] * m, b = B[i] - A[i]*x, d = gcd(M[i], a);</span><br><span class="line">        <span class="keyword">if</span>(b % d != <span class="number">0</span>)  <span class="keyword">return</span> PLL(<span class="number">0</span>, <span class="number">-1</span>);<span class="comment">//答案，不存在，返回-1</span></span><br><span class="line">        LL t = b/d * inv(a/d, M[i]/d)%(M[i]/d);</span><br><span class="line">        x = x + m*t;</span><br><span class="line">        m *= M[i]/d;</span><br><span class="line">    }</span><br><span class="line">    x = (x % m + m ) % m;</span><br><span class="line">    <span class="keyword">return</span> PLL(x, m);<span class="comment">//返回的x就是答案，m是最后的lcm值</span></span><br><span class="line">}</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>{</span><br><span class="line">    <span class="keyword">int</span> n;</span><br><span class="line">    <span class="keyword">while</span>(<span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;n) != EOF){</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i ++){</span><br><span class="line">            a[i] = <span class="number">1</span>;</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>, &amp;m[i], &amp;b[i]);</span><br><span class="line">        }</span><br><span class="line">        PLL ans = linear(a, b, m, n);</span><br><span class="line">        <span class="keyword">if</span>(ans.second == <span class="number">-1</span>) <span class="built_in">printf</span>(<span class="string">"-1\n"</span>);</span><br><span class="line">        <span class="keyword">else</span> <span class="built_in">printf</span>(<span class="string">"%I64d\n"</span>, ans.first);</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<h3 id="1-4-欧拉定理-扩展，-不适用于矩阵"><a href="#1-4-欧拉定理-扩展，-不适用于矩阵" class="headerlink" title="1.4. 欧拉定理(扩展， 不适用于矩阵)"></a>1.4. 欧拉定理(扩展， 不适用于矩阵)</h3><ul>
<li>$a^{b} \equiv a^{b \mod \varphi(p)} \mod p$ (a与p互质)</li>
<li>$a^{b} \equiv a^{b \mod \varphi(p) + \varphi(p)} \mod p$ (a与p不互质)</li>
</ul>
<figure class="highlight cpp"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">ll <span class="title">ph</span><span class="params">(ll x)</span></span></span><br><span class="line"><span class="function"></span>{</span><br><span class="line">    ll res = x, a = x;</span><br><span class="line">    <span class="keyword">for</span>(ll i = <span class="number">2</span>; i * i &lt;= x; i++){</span><br><span class="line">        <span class="keyword">if</span>(a % i == <span class="number">0</span>){</span><br><span class="line">            res = res / i * (i - <span class="number">1</span>);</span><br><span class="line">            <span class="keyword">while</span>(a % i == <span class="number">0</span>) a /= i;</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line">    <span class="keyword">if</span>(a &gt; <span class="number">1</span>) res = res / a * (a - <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">}</span><br><span class="line"><span class="function">ll <span class="title">quick_pow</span><span class="params">(ll a, ll b, ll mod)</span></span></span><br><span class="line"><span class="function"></span>{</span><br><span class="line">    ll ans = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span>(b)</span><br><span class="line">    {</span><br><span class="line">        <span class="keyword">if</span>(b &amp; <span class="number">1</span>) ans = (ans * a) % mod;</span><br><span class="line">        a = (a * a) % mod;</span><br><span class="line">        b &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">    }</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">}</span><br><span class="line"><span class="function">ll <span class="title">ph_pow</span><span class="params">(ll a, ll b, ll mod)</span></span></span><br><span class="line"><span class="function"></span>{</span><br><span class="line">    <span class="keyword">if</span>(gcd(b, mod) == <span class="number">1</span>){</span><br><span class="line">        <span class="keyword">return</span> quick_pow(a, b % (mod - <span class="number">1</span>), mod);</span><br><span class="line">    } <span class="keyword">else</span> {</span><br><span class="line">        ll phi = ph(mod);</span><br><span class="line">        <span class="keyword">return</span> quick_pow(a, b % (phi) + phi, mod);</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<h3 id="1-5-矩阵"><a href="#1-5-矩阵" class="headerlink" title="1.5. 矩阵"></a>1.5. 矩阵</h3><ul>
<li>斐波那契数列求解 $F[n] = F[n-1] + F[n-2]$</li>
<li>则可以看作矩阵$$
\left[\begin{matrix}F[n] \ F[n-1]\end{matrix} \right] = \left[\begin{matrix}1&amp;1 \ 1&amp;0\end{matrix} \right] * \left[\begin{matrix}F[n-1] \ F[n-2]\end{matrix} \right]$$</li>
<li>设$$A = \left[\begin{matrix}1&amp;1 \ 1&amp;0\end{matrix} \right]   B = \left[\begin{matrix}1 \ 1\end{matrix} \right]$$, 则计算F[n]就是计算$A^{n-1}*B$, 再取出矩阵第一项即可。</li>
<li>上述相对应的操作在矩阵上均可运用。</li>
</ul>
<figure class="highlight cpp"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Matrix</span>{</span></span><br><span class="line">    <span class="keyword">int</span> n, m;</span><br><span class="line">    ll a[maxn][maxn];</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">clear</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>{</span><br><span class="line">        n = m = <span class="number">0</span>;</span><br><span class="line">        <span class="built_in">memset</span>(a, <span class="number">0</span>, <span class="keyword">sizeof</span>(a));</span><br><span class="line">    }</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">init</span> <span class="params">(<span class="keyword">int</span> x)</span></span></span><br><span class="line"><span class="function">    </span>{</span><br><span class="line">        n = m = maxn;</span><br><span class="line">        <span class="built_in">memset</span>(a, <span class="number">0</span>, <span class="keyword">sizeof</span>(a));</span><br><span class="line">        <span class="keyword">if</span>(x)</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">3</span>; i++)</span><br><span class="line">                a[i][i] = <span class="number">1</span>;</span><br><span class="line">    }</span><br><span class="line">    Matrix <span class="keyword">operator</span> *(<span class="keyword">const</span> Matrix &amp;b) <span class="keyword">const</span></span><br><span class="line">    {</span><br><span class="line">        Matrix tmp;</span><br><span class="line">        tmp.clear();</span><br><span class="line">        tmp.n = n;</span><br><span class="line">        tmp.m = b.m;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++)</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; b.m; j++)</span><br><span class="line">                <span class="keyword">for</span>(<span class="keyword">int</span> k = <span class="number">0</span>; k &lt; m; k++)</span><br><span class="line">                    (tmp.a[i][j] += a[i][k] * b.a[k][j] % mod) %= mod;</span><br><span class="line">        <span class="keyword">return</span> tmp;</span><br><span class="line">    }</span><br><span class="line">    <span class="function">Matrix <span class="title">qpow</span><span class="params">(ll b)</span></span></span><br><span class="line"><span class="function">    </span>{</span><br><span class="line">        Matrix ans, p = *<span class="keyword">this</span>;</span><br><span class="line">        ans.n = p.n;  </span><br><span class="line">        ans.init(<span class="number">1</span>);</span><br><span class="line">        <span class="keyword">while</span> (b){</span><br><span class="line">            <span class="keyword">if</span> (b &amp; <span class="number">1</span>) ans = ans * p;</span><br><span class="line">            p = p * p;</span><br><span class="line">            b &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">        }</span><br><span class="line">        <span class="keyword">return</span> ans;</span><br><span class="line">    }</span><br><span class="line">};</span><br></pre></td></tr></tbody></table></figure>
<h3 id="1-6-广义斐波那契数列循环节"><a href="#1-6-广义斐波那契数列循环节" class="headerlink" title="1.6. 广义斐波那契数列循环节"></a>1.6. 广义斐波那契数列循环节</h3><figure class="highlight cpp"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="keyword">typedef</span> __int128 i16;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1e5</span> + <span class="number">7</span>;</span><br><span class="line"><span class="keyword">int</span> pr[N], pn;</span><br><span class="line"><span class="built_in">bitset</span>&lt;N&gt; np;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">()</span> </span>{</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">2</span>; i &lt; N; i++) {</span><br><span class="line">        <span class="keyword">if</span>(!np[i]) pr[pn++] = i;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; pn &amp;&amp; i * pr[j] &lt; N; j++) {</span><br><span class="line">            np[i * pr[j]] = <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">if</span>(i % pr[j] == <span class="number">0</span>) <span class="keyword">break</span>;</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"><span class="function">ll <span class="title">getpp</span><span class="params">(<span class="keyword">int</span> p)</span> </span>{</span><br><span class="line">    ll ret = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; pn &amp;&amp; pr[i] * pr[i] &lt;= p; i++) {</span><br><span class="line">        <span class="keyword">if</span>(p % pr[i] == <span class="number">0</span>) {</span><br><span class="line">            ret *= (pr[i] - <span class="number">1ll</span>) * (pr[i] + <span class="number">1</span>);</span><br><span class="line">            p /= pr[i];</span><br><span class="line">            <span class="keyword">while</span>(p % pr[i] == <span class="number">0</span>) p /= pr[i], ret *= pr[i];</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line">    <span class="keyword">if</span>(p != <span class="number">1</span>) ret *= (p - <span class="number">1ll</span>) * (p + <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">return</span> ret;</span><br><span class="line">}</span><br><span class="line"><span class="comment">//使用方式</span></span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%s%d"</span>, s, &amp;mod);</span><br><span class="line"><span class="keyword">int</span> len = <span class="built_in">strlen</span>(s);</span><br><span class="line">ll ord = getpp(mod), r = <span class="number">0</span>;<span class="comment">//ord为循环节长度</span></span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; len; i++) {</span><br><span class="line">    r = ((i16)r * <span class="number">10</span> + s[i] - <span class="string">'0'</span>) % ord;<span class="comment">//简化r的大小</span></span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<h3 id="1-7-整除分块"><a href="#1-7-整除分块" class="headerlink" title="1.7. 整除分块"></a>1.7. 整除分块</h3><p>正常整除分块为</p>
<p>$ans = (ans + ((n / l) * (r – l + 1) mod m) mod m$</p>
<p>求$\sum_{i=1}^n \lfloor n/i\rfloor * i^2  mod 1e9+7$</p>
<figure class="highlight cpp"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> LL;</span><br><span class="line"><span class="keyword">const</span> LL mod = <span class="number">1e9</span> + <span class="number">7</span>;</span><br><span class="line"><span class="keyword">const</span> LL inv = <span class="number">166666668</span>;</span><br><span class="line"><span class="keyword">const</span> LL inv2 = <span class="number">500000004</span>;</span><br><span class="line"><span class="function">LL <span class="title">f</span><span class="params">(LL x)</span></span></span><br><span class="line"><span class="function"></span>{</span><br><span class="line">    <span class="keyword">return</span> ((((x * (x + <span class="number">1</span>)) % mod) * (<span class="number">2</span> * x + <span class="number">1</span>) % mod) % mod) * inv % mod;</span><br><span class="line">}</span><br><span class="line"><span class="function">LL <span class="title">call</span><span class="params">(LL n, LL m)</span></span></span><br><span class="line"><span class="function"></span>{</span><br><span class="line">    LL ans = <span class="number">0</span>, ans1 = <span class="number">0</span>, t1 = ((((n * n) % mod) * (n + <span class="number">1</span>)) % mod) * inv2 % mod, t2 = ((((m * m) % mod) * (m + <span class="number">1</span>)) % mod) * inv2 % mod;</span><br><span class="line">    <span class="keyword">for</span>(LL l = <span class="number">1</span>, r; l &lt;= n; l = r + <span class="number">1</span>){</span><br><span class="line">        r = n / (n / l);</span><br><span class="line">        LL tmp = (f(r) - f(l - <span class="number">1</span>) + mod) % mod;</span><br><span class="line">        ans = (ans + ((n / l) * tmp) % mod) % mod;</span><br><span class="line">    }</span><br><span class="line">    ans = (t1 + mod - ans) % mod;</span><br><span class="line">    <span class="keyword">for</span>(LL l = <span class="number">1</span>, r; l &lt;= m; l = r + <span class="number">1</span>){</span><br><span class="line">        r = m / (m / l);</span><br><span class="line">        LL tmp = (f(r) - f(l - <span class="number">1</span>) + mod) % mod;</span><br><span class="line">        ans1 = (ans1 + ((m / l) * tmp) % mod) % mod;</span><br><span class="line">    }</span><br><span class="line">    ans1 = (t2 + mod - ans1) % mod;</span><br><span class="line">    <span class="keyword">return</span> (ans * ans1) % mod;</span><br><span class="line">}</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>{</span><br><span class="line">    LL n, m;</span><br><span class="line">    <span class="keyword">while</span>(~<span class="built_in">scanf</span>(<span class="string">"%lld %lld"</span>, &amp;n, &amp;m)){</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>, call(n, m));</span><br><span class="line">    }</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">}</span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure>
<h3 id="1-8-莫比乌斯反演"><a href="#1-8-莫比乌斯反演" class="headerlink" title="1.8. 莫比乌斯反演"></a>1.8. 莫比乌斯反演</h3><img src="/gallery/banzi/mobius.png" class="box px-0 py-0 ml-auto mr-auto" width="720" title="mobius-png" alt="mobius-png">

<img src="/gallery/banzi/mobius1.png" class="box px-0 py-0 ml-auto mr-auto" width="720" title="mobius-png" alt="mobius1-png">

<p>这里的ans后面少了mu函数，代码是对的</p>
<figure class="highlight cpp"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">long</span> <span class="keyword">long</span> MAXN=<span class="number">1e6</span>+<span class="number">5</span>;</span><br><span class="line"><span class="comment">//线性筛法求莫比乌斯函数</span></span><br><span class="line"><span class="keyword">bool</span> check[MAXN+<span class="number">10</span>];</span><br><span class="line"><span class="keyword">long</span> <span class="keyword">long</span> prime[MAXN+<span class="number">10</span>];</span><br><span class="line"><span class="keyword">int</span> mu[MAXN+<span class="number">10</span>];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Moblus</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>{</span><br><span class="line">    <span class="built_in">memset</span>(check,<span class="literal">false</span>,<span class="keyword">sizeof</span>(check));</span><br><span class="line">    mu[<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">long</span> <span class="keyword">long</span> tot = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">long</span> <span class="keyword">long</span> i = <span class="number">2</span>; i &lt;= MAXN; i++)</span><br><span class="line">    {</span><br><span class="line">        <span class="keyword">if</span>( !check[i] ){</span><br><span class="line">            prime[tot++] = i;</span><br><span class="line">            mu[i] = <span class="number">-1</span>;</span><br><span class="line">        }</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">long</span> <span class="keyword">long</span> j = <span class="number">0</span>; j &lt; tot; j++)</span><br><span class="line">        {</span><br><span class="line">            <span class="keyword">if</span>(i * prime[j] &gt; MAXN) <span class="keyword">break</span>;</span><br><span class="line">            check[i * prime[j]] = <span class="literal">true</span>;</span><br><span class="line">            <span class="keyword">if</span>( i % prime[j] == <span class="number">0</span>){</span><br><span class="line">                mu[i * prime[j]] = <span class="number">0</span>;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            }<span class="keyword">else</span>{</span><br><span class="line">                mu[i * prime[j]] = -mu[i];</span><br><span class="line">            }</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>{</span><br><span class="line">    Moblus();</span><br><span class="line">    <span class="keyword">int</span> t;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;t);</span><br><span class="line">    <span class="keyword">while</span>(t--)</span><br><span class="line">    {</span><br><span class="line">        <span class="keyword">long</span> <span class="keyword">long</span>  n;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%lld"</span>,&amp;n);</span><br><span class="line">        <span class="keyword">long</span> <span class="keyword">long</span> ans=<span class="number">3</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">long</span> <span class="keyword">long</span> i=<span class="number">1</span>;i&lt;=n;i++) ans+=mu[i]*(n/i)*(n/i)*(n/i+<span class="number">3</span>);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>,ans);</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<h3 id="1-9-Lucas"><a href="#1-9-Lucas" class="headerlink" title="1.9. Lucas"></a>1.9. Lucas</h3><figure class="highlight cpp"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//Lucas定理实现C(n,m)%p的代码：p为素数</span></span><br><span class="line"><span class="function">LL <span class="title">exp_mod</span><span class="params">(LL a, LL b, LL p)</span></span></span><br><span class="line"><span class="function"></span>{ <span class="comment">//快速幂取模</span></span><br><span class="line">    LL res = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span>(b != <span class="number">0</span>)</span><br><span class="line">    {</span><br><span class="line">        <span class="keyword">if</span>(b&amp;<span class="number">1</span>) res = (res * a) % p;</span><br><span class="line">        a = (a*a) % p;</span><br><span class="line">        b &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">    }</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">}</span><br><span class="line"><span class="function">LL <span class="title">Comb</span><span class="params">(LL a, LL b, LL p)</span></span></span><br><span class="line"><span class="function"></span>{ <span class="comment">//求组合数C(a,b)%p</span></span><br><span class="line">    <span class="keyword">if</span>(a &lt; b)   <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">if</span>(a == b)  <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span>(b &gt; a - b)   b = a - b;</span><br><span class="line">    LL ans = <span class="number">1</span>, ca = <span class="number">1</span>, cb = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(LL i = <span class="number">0</span>; i &lt; b; ++i)</span><br><span class="line">    {</span><br><span class="line">        ca = (ca * (a - i))%p;</span><br><span class="line">        cb = (cb * (b - i))%p;</span><br><span class="line">    }</span><br><span class="line">    ans = (ca*exp_mod(cb, p - <span class="number">2</span>, p)) % p;</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">}</span><br><span class="line"><span class="function">LL <span class="title">Lucas</span><span class="params">(LL n,LL m,LL p)</span></span></span><br><span class="line"><span class="function"></span>{ <span class="comment">//Lucas定理求C(n,m)%p</span></span><br><span class="line">     LL ans = <span class="number">1</span>;</span><br><span class="line">     <span class="keyword">while</span>(n&amp;&amp;m&amp;&amp;ans)</span><br><span class="line">    {</span><br><span class="line">        ans = (ans*Comb(n%p, m%p, p)) % p;</span><br><span class="line">        n /= p;</span><br><span class="line">        m /= p;</span><br><span class="line">     }</span><br><span class="line">     <span class="keyword">return</span> ans;</span><br><span class="line">}</span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure>
<ul>
<li>组合数取模</li>
</ul>
<figure class="highlight cpp"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> LL;</span><br><span class="line">const LL maxn(1000005), mod(1e9 + 7);</span><br><span class="line">LL Jc[maxn];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">calJc</span><span class="params">()</span>    <span class="comment">//求maxn以内的数的阶乘</span></span></span><br><span class="line"><span class="function"></span>{</span><br><span class="line">    Jc[<span class="number">0</span>] = Jc[<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(LL i = <span class="number">2</span>; i &lt; maxn; i++)</span><br><span class="line">        Jc[i] = Jc[i - <span class="number">1</span>] * i % mod;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<h3 id="1-10-逆元"><a href="#1-10-逆元" class="headerlink" title="1.10. 逆元"></a>1.10. 逆元</h3><ul>
<li>费马小定理求逆元</li>
</ul>
<figure class="highlight cpp"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">LL <span class="title">pow</span><span class="params">(LL a, LL n, LL p)</span>    <span class="comment">//快速幂 a^n % p</span></span></span><br><span class="line"><span class="function"></span>{</span><br><span class="line">    LL ans = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span>(n)</span><br><span class="line">    {</span><br><span class="line">        <span class="keyword">if</span>(n &amp; <span class="number">1</span>) ans = ans * a % p;</span><br><span class="line">        a = a * a % p;</span><br><span class="line">        n &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">    }</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">}</span><br><span class="line"><span class="function">LL <span class="title">niYuan</span><span class="params">(LL a, LL b)</span>   <span class="comment">//费马小定理求逆元</span></span></span><br><span class="line"><span class="function"></span>{</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">pow</span>(a, b - <span class="number">2</span>, b);</span><br><span class="line">}</span><br><span class="line"><span class="function">LL <span class="title">C</span><span class="params">(LL a, LL b)</span>    <span class="comment">//计算C(a, b)</span></span></span><br><span class="line"><span class="function"></span>{</span><br><span class="line">    <span class="keyword">return</span> Jc[a] * niYuan(Jc[b], mod) % mod</span><br><span class="line"></span><br><span class="line">        * niYuan(Jc[a - b], mod) % mod;</span><br><span class="line"></span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<ul>
<li>拓展欧几里得算法求逆元</li>
</ul>
<figure class="highlight cpp"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">exgcd</span><span class="params">(LL a, LL b, LL &amp;x, LL &amp;y)</span>    <span class="comment">//拓展欧几里得算法</span></span></span><br><span class="line"><span class="function"></span>{</span><br><span class="line">    <span class="keyword">if</span>(!b) x = <span class="number">1</span>, y = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    {</span><br><span class="line">        exgcd(b, a % b, y, x);</span><br><span class="line">        y -= x * (a / b);</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"><span class="function">LL <span class="title">niYuan</span><span class="params">(LL a, LL b)</span>   <span class="comment">//求a对b取模的逆元</span></span></span><br><span class="line"><span class="function"></span>{</span><br><span class="line">    LL x, y;</span><br><span class="line">    exgcd(a, b, x, y);</span><br><span class="line">    <span class="keyword">return</span> (x + b) % b;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<ul>
<li>线性求逆元</li>
</ul>
<figure class="highlight cpp"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> maxn 3000006</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> LL long long</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">int</span> n,p,inv[maxn];</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>{</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;n,&amp;p);</span><br><span class="line">    inv[<span class="number">1</span>]=<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">2</span>;i&lt;=n;i++)inv[i]=(p-(LL)p/i*inv[p%i]%p)%p;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;i++)<span class="built_in">printf</span>(<span class="string">"%d\n"</span>,inv[i]);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<h3 id="1-11-BM算法"><a href="#1-11-BM算法" class="headerlink" title="1.11. BM算法"></a>1.11. BM算法</h3><ul>
<li>给出前k项，即可求出第n项，只能用于符合递推方程形式的方程</li>
</ul>
<figure class="highlight cpp"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cmath&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;map&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;set&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cassert&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rep(i,a,n) for (int i=a;i&lt;n;i++)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> per(i,a,n) for (int i=n-1;i&gt;=a;i--)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> pb push_back</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> mp make_pair</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> all(x) (x).begin(),(x).end()</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> fi first</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> se second</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> SZ(x) ((int)(x).size())</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; VI;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="keyword">typedef</span> <span class="built_in">pair</span>&lt;<span class="keyword">int</span>,<span class="keyword">int</span>&gt; PII;</span><br><span class="line"><span class="keyword">const</span> ll mod=<span class="number">1000000007</span>;</span><br><span class="line"><span class="function">ll <span class="title">powmod</span><span class="params">(ll a,ll b)</span> </span>{ll res=<span class="number">1</span>;a%=mod; assert(b&gt;=<span class="number">0</span>); <span class="keyword">for</span>(;b;b&gt;&gt;=<span class="number">1</span>){<span class="keyword">if</span>(b&amp;<span class="number">1</span>)res=res*a%mod;a=a*a%mod;}<span class="keyword">return</span> res;}</span><br><span class="line"><span class="comment">// head</span></span><br><span class="line"><span class="keyword">int</span> _;</span><br><span class="line">ll n;</span><br><span class="line"><span class="keyword">namespace</span> linear_seq {</span><br><span class="line">    <span class="keyword">const</span> <span class="keyword">int</span> N=<span class="number">10010</span>;</span><br><span class="line">    ll res[N],base[N],_c[N],_md[N];</span><br><span class="line">    <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; Md;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">mul</span><span class="params">(ll *a,ll *b,<span class="keyword">int</span> k)</span> </span>{</span><br><span class="line">        rep(i,<span class="number">0</span>,k+k) _c[i]=<span class="number">0</span>;</span><br><span class="line">        rep(i,<span class="number">0</span>,k) <span class="keyword">if</span> (a[i]) rep(j,<span class="number">0</span>,k) _c[i+j]=(_c[i+j]+a[i]*b[j])%mod;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i=k+k<span class="number">-1</span>;i&gt;=k;i--) <span class="keyword">if</span> (_c[i])</span><br><span class="line">            rep(j,<span class="number">0</span>,SZ(Md)) _c[i-k+Md[j]]=(_c[i-k+Md[j]]-_c[i]*_md[Md[j]])%mod;</span><br><span class="line">        rep(i,<span class="number">0</span>,k) a[i]=_c[i];</span><br><span class="line">    }</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">solve</span><span class="params">(ll n,VI a,VI b)</span> </span>{ <span class="comment">// a 系数 b 初值 b[n+1]=a[0]*b[n]+...</span></span><br><span class="line">        <span class="comment">//        printf("%d\n",SZ(b));</span></span><br><span class="line">        ll ans=<span class="number">0</span>,pnt=<span class="number">0</span>;</span><br><span class="line">        <span class="keyword">int</span> k=SZ(a);</span><br><span class="line">        assert(SZ(a)==SZ(b));</span><br><span class="line">        rep(i,<span class="number">0</span>,k) _md[k<span class="number">-1</span>-i]=-a[i];_md[k]=<span class="number">1</span>;</span><br><span class="line">        Md.clear();</span><br><span class="line">        rep(i,<span class="number">0</span>,k) <span class="keyword">if</span> (_md[i]!=<span class="number">0</span>) Md.push_back(i);</span><br><span class="line">        rep(i,<span class="number">0</span>,k) res[i]=base[i]=<span class="number">0</span>;</span><br><span class="line">        res[<span class="number">0</span>]=<span class="number">1</span>;</span><br><span class="line">        <span class="keyword">while</span> ((<span class="number">1ll</span>&lt;&lt;pnt)&lt;=n) pnt++;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> p=pnt;p&gt;=<span class="number">0</span>;p--) {</span><br><span class="line">            mul(res,res,k);</span><br><span class="line">            <span class="keyword">if</span> ((n&gt;&gt;p)&amp;<span class="number">1</span>) {</span><br><span class="line">                <span class="keyword">for</span> (<span class="keyword">int</span> i=k<span class="number">-1</span>;i&gt;=<span class="number">0</span>;i--) res[i+<span class="number">1</span>]=res[i];res[<span class="number">0</span>]=<span class="number">0</span>;</span><br><span class="line">                rep(j,<span class="number">0</span>,SZ(Md)) res[Md[j]]=(res[Md[j]]-res[k]*_md[Md[j]])%mod;</span><br><span class="line">            }</span><br><span class="line">        }</span><br><span class="line">        rep(i,<span class="number">0</span>,k) ans=(ans+res[i]*b[i])%mod;</span><br><span class="line">        <span class="keyword">if</span> (ans&lt;<span class="number">0</span>) ans+=mod;</span><br><span class="line">        <span class="keyword">return</span> ans;</span><br><span class="line">    }</span><br><span class="line">    <span class="function">VI <span class="title">BM</span><span class="params">(VI s)</span> </span>{</span><br><span class="line">        VI C(1,1),B(1,1);</span><br><span class="line">        <span class="keyword">int</span> L=<span class="number">0</span>,m=<span class="number">1</span>,b=<span class="number">1</span>;</span><br><span class="line">        rep(n,<span class="number">0</span>,SZ(s)) {</span><br><span class="line">            ll d=<span class="number">0</span>;</span><br><span class="line">            rep(i,<span class="number">0</span>,L+<span class="number">1</span>) d=(d+(ll)C[i]*s[n-i])%mod;</span><br><span class="line">            <span class="keyword">if</span> (d==<span class="number">0</span>) ++m;</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span> (<span class="number">2</span>*L&lt;=n) {</span><br><span class="line">                VI T=C;</span><br><span class="line">                ll c=mod-d*powmod(b,mod<span class="number">-2</span>)%mod;</span><br><span class="line">                <span class="keyword">while</span> (SZ(C)&lt;SZ(B)+m) C.pb(<span class="number">0</span>);</span><br><span class="line">                rep(i,<span class="number">0</span>,SZ(B)) C[i+m]=(C[i+m]+c*B[i])%mod;</span><br><span class="line">                L=n+<span class="number">1</span>-L; B=T; b=d; m=<span class="number">1</span>;</span><br><span class="line">            } <span class="keyword">else</span> {</span><br><span class="line">                ll c=mod-d*powmod(b,mod<span class="number">-2</span>)%mod;</span><br><span class="line">                <span class="keyword">while</span> (SZ(C)&lt;SZ(B)+m) C.pb(<span class="number">0</span>);</span><br><span class="line">                rep(i,<span class="number">0</span>,SZ(B)) C[i+m]=(C[i+m]+c*B[i])%mod;</span><br><span class="line">                ++m;</span><br><span class="line">            }</span><br><span class="line">        }</span><br><span class="line">        <span class="keyword">return</span> C;</span><br><span class="line">    }</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">gao</span><span class="params">(VI a,ll n)</span> </span>{</span><br><span class="line">        VI c=BM(a);</span><br><span class="line">        c.erase(c.begin());</span><br><span class="line">        rep(i,<span class="number">0</span>,SZ(c)) c[i]=(mod-c[i])%mod;</span><br><span class="line">        <span class="keyword">return</span> solve(n,c,VI(a.begin(),a.begin()+SZ(c)));</span><br><span class="line">    }</span><br><span class="line">};</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>{</span><br><span class="line">    <span class="keyword">for</span> (<span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;_);_;_--) {</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%lld"</span>,&amp;n);</span><br><span class="line">        <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;a;</span><br><span class="line">        a.push_back(<span class="number">1</span>);</span><br><span class="line">        a.push_back(<span class="number">3</span>);</span><br><span class="line">        a.push_back(<span class="number">5</span>);</span><br><span class="line">        a.push_back(<span class="number">7</span>);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"%d\n"</span>,linear_seq::gao(a,n<span class="number">-1</span>));</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<h3 id="1-12-二次剩余"><a href="#1-12-二次剩余" class="headerlink" title="1.12. 二次剩余"></a>1.12. 二次剩余</h3><figure class="highlight cpp"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ll long long</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> re register</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> gc getchar</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> pc putchar</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> puts put_s</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> cs const</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> IO{</span><br><span class="line">    <span class="keyword">namespace</span> READONLY{</span><br><span class="line">        cs <span class="keyword">int</span> Rlen=<span class="number">1</span>&lt;&lt;<span class="number">18</span>|<span class="number">1</span>;</span><br><span class="line">        <span class="keyword">char</span> buf[Rlen],*p1,*p2;</span><br><span class="line">        <span class="keyword">char</span> obuf[Rlen],*p3=obuf;</span><br><span class="line">        <span class="keyword">char</span> ch[<span class="number">23</span>];</span><br><span class="line">    }</span><br><span class="line">    <span class="function"><span class="keyword">inline</span> <span class="keyword">char</span> <span class="title">get_char</span><span class="params">()</span></span>{</span><br><span class="line">        <span class="keyword">using</span> <span class="keyword">namespace</span> READONLY;</span><br><span class="line">        <span class="keyword">return</span> (p1==p2)&amp;&amp;(p2=(p1=buf)+fread(buf,<span class="number">1</span>,Rlen,<span class="built_in">stdin</span>),p1==p2)?EOF:*p1++;</span><br><span class="line">    }</span><br><span class="line">    <span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">put_char</span><span class="params">(cs <span class="keyword">char</span> &amp;c)</span></span>{</span><br><span class="line">        <span class="keyword">using</span> <span class="keyword">namespace</span> READONLY;</span><br><span class="line">        *p3++=c;</span><br><span class="line">        <span class="keyword">if</span>(p3==obuf+Rlen)fwrite(obuf,<span class="number">1</span>,Rlen,<span class="built_in">stdout</span>),p3=obuf;</span><br><span class="line">    }</span><br><span class="line">    <span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">put_s</span><span class="params">(cs <span class="keyword">char</span> *s)</span></span>{</span><br><span class="line">        <span class="keyword">for</span>(;*s;++s)pc(*s);</span><br><span class="line">        pc(<span class="string">'\n'</span>);</span><br><span class="line">    }</span><br><span class="line">    <span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">FLUSH</span><span class="params">()</span></span>{</span><br><span class="line">        <span class="keyword">using</span> <span class="keyword">namespace</span> READONLY;</span><br><span class="line">        fwrite(obuf,<span class="number">1</span>,p3-obuf,<span class="built_in">stdout</span>);</span><br><span class="line">        p3=obuf;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">inline</span> ll <span class="title">getint</span><span class="params">()</span></span>{</span><br><span class="line">        re ll num;</span><br><span class="line">        re <span class="keyword">char</span> c;</span><br><span class="line">        <span class="keyword">while</span>(!<span class="built_in">isdigit</span>(c=gc()));num=c^<span class="number">48</span>;</span><br><span class="line">        <span class="keyword">while</span>(<span class="built_in">isdigit</span>(c=gc()))num=(num+(num&lt;&lt;<span class="number">2</span>)&lt;&lt;<span class="number">1</span>)+(c^<span class="number">48</span>);</span><br><span class="line">        <span class="keyword">return</span> num;</span><br><span class="line">    }</span><br><span class="line">    <span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">outint</span><span class="params">(ll a)</span></span>{</span><br><span class="line">        <span class="keyword">using</span> <span class="keyword">namespace</span> READONLY;</span><br><span class="line">        <span class="keyword">if</span>(a==<span class="number">0</span>)pc(<span class="string">'0'</span>);</span><br><span class="line">        <span class="keyword">if</span>(a&lt;<span class="number">0</span>)pc(<span class="string">'-'</span>),a=-a;</span><br><span class="line">        <span class="keyword">while</span>(a)ch[++ch[<span class="number">0</span>]]=a-a/<span class="number">10</span>*<span class="number">10</span>,a/=<span class="number">10</span>;</span><br><span class="line">        <span class="keyword">while</span>(ch[<span class="number">0</span>])pc(ch[ch[<span class="number">0</span>]--]^<span class="number">48</span>);</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> IO;</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> Linear_sieves{</span><br><span class="line">    cs <span class="keyword">int</span> P=<span class="number">300005</span>;</span><br><span class="line">    <span class="keyword">int</span> prime[P],pcnt;</span><br><span class="line">    <span class="keyword">bool</span> mark[P];</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">init</span><span class="params">(<span class="keyword">int</span> len=P<span class="number">-5</span>)</span></span>{</span><br><span class="line">        mark[<span class="number">1</span>]=<span class="literal">true</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> re i=<span class="number">2</span>;i&lt;=len;++i){</span><br><span class="line">            <span class="keyword">if</span>(!mark[i])prime[++pcnt]=i;</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> re j=<span class="number">1</span>;j&lt;=pcnt&amp;&amp;i*prime[j]&lt;=len;++j){</span><br><span class="line">                mark[i*prime[j]]=<span class="literal">true</span>;</span><br><span class="line">                <span class="keyword">if</span>(i%prime[j]==<span class="number">0</span>)<span class="keyword">break</span>;</span><br><span class="line">            }</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> Find_root{</span><br><span class="line">    <span class="meta">#<span class="meta-keyword">define</span> complex COMPLEX</span></span><br><span class="line">    <span class="keyword">using</span> <span class="keyword">namespace</span> Linear_sieves;</span><br><span class="line">    <span class="function"><span class="keyword">inline</span> ll <span class="title">mul</span><span class="params">(cs ll &amp;a,cs ll &amp;b,cs ll &amp;mod)</span></span>{</span><br><span class="line">        <span class="keyword">return</span> (a*b-(ll)((<span class="keyword">long</span> <span class="keyword">double</span>)a/mod*b)*mod+mod)%mod;</span><br><span class="line">    }</span><br><span class="line">    <span class="function"><span class="keyword">inline</span> ll <span class="title">quickpow</span><span class="params">(ll a,ll b,cs ll &amp;mod,ll res=<span class="number">1</span>)</span></span>{</span><br><span class="line">        <span class="keyword">for</span>(;b;b&gt;&gt;=<span class="number">1</span>,a=mul(a,a,mod))<span class="keyword">if</span>(b&amp;<span class="number">1</span>)res=mul(res,a,mod);</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">inline</span> ll <span class="title">ex_gcd</span><span class="params">(cs ll &amp;a,cs ll &amp;b,ll &amp;x,ll &amp;y)</span></span>{</span><br><span class="line">        <span class="keyword">if</span>(!b){</span><br><span class="line">            y=<span class="number">0</span>;</span><br><span class="line">            x=<span class="number">1</span>;</span><br><span class="line">            <span class="keyword">return</span> a;</span><br><span class="line">        }</span><br><span class="line">        ll t=ex_gcd(b,a-a/b*b,y,x);</span><br><span class="line">        y-=(a/b)*x;</span><br><span class="line">        <span class="keyword">return</span> t;</span><br><span class="line">    }</span><br><span class="line">    <span class="function"><span class="keyword">inline</span> ll <span class="title">inv</span><span class="params">(cs ll a,cs ll mod)</span></span>{</span><br><span class="line">        ll x,y;</span><br><span class="line">        ll t=ex_gcd(a,mod,x,y);</span><br><span class="line">        <span class="keyword">return</span> (x%mod+mod)%mod;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    ll W,Mod;</span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">complex</span>{</span></span><br><span class="line">        <span class="keyword">public</span>:</span><br><span class="line">            ll x,y;</span><br><span class="line">            <span class="built_in">complex</span>(cs ll &amp;_x=<span class="number">0</span>,cs ll &amp;_y=<span class="number">0</span>):x(_x),y(_y){}</span><br><span class="line">            <span class="keyword">inline</span> <span class="keyword">friend</span> <span class="built_in">complex</span> <span class="keyword">operator</span>*(cs <span class="built_in">complex</span> &amp;a,cs <span class="built_in">complex</span> &amp;b){</span><br><span class="line">                <span class="keyword">return</span> <span class="built_in">complex</span>(</span><br><span class="line">                    (mul(a.x,b.x,Mod)+mul(mul(a.y,b.y,Mod),W,Mod))%Mod,</span><br><span class="line">                    (mul(a.x,b.y,Mod)+mul(a.y,b.x,Mod))%Mod);</span><br><span class="line">            }</span><br><span class="line">    };</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="built_in">complex</span> <span class="title">quickpow</span><span class="params">(<span class="built_in">complex</span> a,ll b)</span></span>{</span><br><span class="line">        <span class="function"><span class="built_in">complex</span> <span class="title">res</span><span class="params">(<span class="number">1</span>,<span class="number">0</span>)</span></span>;</span><br><span class="line">        <span class="keyword">for</span>(;b;b&gt;&gt;=<span class="number">1</span>,a=a*a)<span class="keyword">if</span>(b&amp;<span class="number">1</span>)res=res*a;</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">inline</span> <span class="keyword">bool</span> <span class="title">isprime</span><span class="params">(ll x)</span></span>{</span><br><span class="line">        <span class="keyword">if</span>(x&lt;=P<span class="number">-5</span>)<span class="keyword">return</span> !mark[x];</span><br><span class="line">        <span class="keyword">if</span>(x%<span class="number">2</span>==<span class="number">0</span>||x%<span class="number">3</span>==<span class="number">0</span>||x%<span class="number">5</span>==<span class="number">0</span>||x%<span class="number">7</span>==<span class="number">0</span>||x%<span class="number">31</span>==<span class="number">0</span>||x%<span class="number">24251</span>==<span class="number">0</span>)<span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        re ll t=x<span class="number">-1</span>,s;</span><br><span class="line">        t&gt;&gt;=(s=__builtin_ctzll(t));</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> re i=<span class="number">1</span>;i&lt;=<span class="number">5</span>;++i){</span><br><span class="line">            re ll p=prime[rand()%pcnt+<span class="number">1</span>];</span><br><span class="line">            re ll num=quickpow(p,t,x),pre=num;</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> re j=<span class="number">0</span>;j&lt;s;++j){</span><br><span class="line">                num=mul(num,num,x);</span><br><span class="line">                <span class="keyword">if</span>(num==<span class="number">1</span>&amp;&amp;pre!=x<span class="number">-1</span>&amp;&amp;pre!=<span class="number">1</span>)<span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">                pre=num;</span><br><span class="line">                <span class="keyword">if</span>(num==<span class="number">1</span>)<span class="keyword">break</span>;</span><br><span class="line">            }</span><br><span class="line">            <span class="keyword">if</span>(num^<span class="number">1</span>)<span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        }</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">inline</span> ll <span class="title">Pollard_rho</span><span class="params">(ll x)</span></span>{</span><br><span class="line">        <span class="keyword">if</span>(x%<span class="number">2</span>==<span class="number">0</span>)<span class="keyword">return</span> <span class="number">2</span>;</span><br><span class="line">        <span class="keyword">if</span>(x%<span class="number">3</span>==<span class="number">0</span>)<span class="keyword">return</span> <span class="number">3</span>;</span><br><span class="line">        <span class="keyword">if</span>(x%<span class="number">5</span>==<span class="number">0</span>)<span class="keyword">return</span> <span class="number">5</span>;</span><br><span class="line">        <span class="keyword">if</span>(x%<span class="number">7</span>==<span class="number">0</span>)<span class="keyword">return</span> <span class="number">7</span>;</span><br><span class="line">        <span class="keyword">if</span>(x%<span class="number">31</span>==<span class="number">0</span>)<span class="keyword">return</span> <span class="number">31</span>;</span><br><span class="line">        <span class="keyword">if</span>(x%<span class="number">24251</span>==<span class="number">0</span>)<span class="keyword">return</span> <span class="number">24251</span>;</span><br><span class="line">        re ll n=<span class="number">0</span>,m=<span class="number">0</span>,t=<span class="number">1</span>,q=<span class="number">1</span>,c=rand()%(x<span class="number">-2</span>)+<span class="number">2</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> re k=<span class="number">2</span>;;k&lt;&lt;=<span class="number">1</span>,m=n,q=<span class="number">1</span>){</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> re i=<span class="number">1</span>;i&lt;=k;++i){</span><br><span class="line">                n=(mul(n,n,x)+c)%x;</span><br><span class="line">                q=mul(q,<span class="built_in">abs</span>(n-m),x);</span><br><span class="line">            }</span><br><span class="line">            <span class="keyword">if</span>((t=__gcd(q,x))&gt;<span class="number">1</span>)<span class="keyword">return</span> t;</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    ll fact[<span class="number">60</span>],cntf;</span><br><span class="line">    <span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">sieves</span><span class="params">(ll x)</span></span>{</span><br><span class="line">        <span class="keyword">if</span>(x==<span class="number">1</span>)<span class="keyword">return</span> ;</span><br><span class="line">        <span class="keyword">if</span>(isprime(x)){fact[++cntf]=x;<span class="keyword">return</span>;}</span><br><span class="line">        re ll p=x;</span><br><span class="line">        <span class="keyword">while</span>(p==x)p=Pollard_rho(p);</span><br><span class="line">        sieves(p);</span><br><span class="line">        <span class="keyword">while</span>(x%p==<span class="number">0</span>)x/=p;</span><br><span class="line">        sieves(x);</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">inline</span> ll <span class="title">solve_2k</span><span class="params">(ll a,ll k)</span></span>{</span><br><span class="line">        <span class="keyword">if</span>(a%(<span class="number">1</span>&lt;&lt;k)==<span class="number">0</span>)<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        a%=(<span class="number">1</span>&lt;&lt;k);</span><br><span class="line">        re ll t=<span class="number">0</span>,res=<span class="number">1</span>;</span><br><span class="line">        a&gt;&gt;=(t=__builtin_ctzll(a));</span><br><span class="line">        <span class="keyword">if</span>((a&amp;<span class="number">7</span>)^<span class="number">1</span>)<span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">        <span class="keyword">if</span>(t&amp;<span class="number">1</span>)<span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">        k-=t;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> re i=<span class="number">4</span>;i&lt;=k;++i){</span><br><span class="line">            res=(res+(a%(<span class="number">1</span>&lt;&lt;i)-res*res)/<span class="number">2</span>)%(<span class="number">1</span>&lt;&lt;k);</span><br><span class="line">        }</span><br><span class="line">        res%=<span class="number">1</span>&lt;&lt;k;</span><br><span class="line">        <span class="keyword">if</span>(res&lt;<span class="number">0</span>)res+=<span class="number">1</span>&lt;&lt;k;</span><br><span class="line">        <span class="keyword">return</span> res&lt;&lt;(t&gt;&gt;<span class="number">1</span>);</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">inline</span> ll <span class="title">solve_p</span><span class="params">(ll a,ll p)</span></span>{</span><br><span class="line">        a%=p;</span><br><span class="line">        <span class="keyword">if</span>(quickpow(a,(p<span class="number">-1</span>)&gt;&gt;<span class="number">1</span>,p)==p<span class="number">-1</span>)<span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">        re ll b;</span><br><span class="line">        Mod=p;</span><br><span class="line">        <span class="keyword">while</span>(<span class="literal">true</span>){</span><br><span class="line">            b=rand()%p;</span><br><span class="line">            W=(mul(b,b,p)-a+p)%p;</span><br><span class="line">            <span class="keyword">if</span>(quickpow(W,(p<span class="number">-1</span>)&gt;&gt;<span class="number">1</span>,p)==p<span class="number">-1</span>)<span class="keyword">break</span>;</span><br><span class="line">        }</span><br><span class="line">        re ll ans=quickpow(<span class="built_in">complex</span>(b,<span class="number">1</span>),(p+<span class="number">1</span>)&gt;&gt;<span class="number">1</span>).x;</span><br><span class="line">        <span class="keyword">return</span> min(ans,p-ans);</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">inline</span> ll <span class="title">solve_pk</span><span class="params">(ll a,ll k,ll p,ll mod)</span></span>{</span><br><span class="line">        <span class="keyword">if</span>(a%mod==<span class="number">0</span>)<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        re ll t=<span class="number">0</span>,hmod=<span class="number">1</span>;</span><br><span class="line">        <span class="keyword">while</span>(a%p==<span class="number">0</span>)a/=p,++t,hmod*=(t&amp;<span class="number">1</span>)?p:<span class="number">1</span>;</span><br><span class="line">        <span class="keyword">if</span>(t&amp;<span class="number">1</span>)<span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">        k-=t;</span><br><span class="line">        mod/=hmod*hmod;</span><br><span class="line">        re ll res=solve_p(a,p);</span><br><span class="line">        <span class="keyword">if</span>(res==<span class="number">-1</span>)<span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">        <span class="function"><span class="built_in">complex</span> <span class="title">tmp</span><span class="params">(res,<span class="number">1</span>)</span></span>;</span><br><span class="line">        W=a;</span><br><span class="line">        Mod=mod;</span><br><span class="line">        tmp=quickpow(tmp,k);</span><br><span class="line">        res=mul(tmp.x,inv(tmp.y,Mod),Mod);</span><br><span class="line">        <span class="keyword">return</span> res*hmod;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    ll remain[<span class="number">20</span>],mod[<span class="number">20</span>],p;</span><br><span class="line">    <span class="function"><span class="keyword">inline</span> ll <span class="title">CRT</span><span class="params">()</span></span>{</span><br><span class="line">        re ll ans=<span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> re i=<span class="number">1</span>;i&lt;=cntf;++i){</span><br><span class="line">            ans=(ans+mul(mul(p/mod[i],inv(p/mod[i],mod[i]),p),remain[i],p))%p;</span><br><span class="line">        }</span><br><span class="line">        <span class="keyword">return</span> ans;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">inline</span> ll <span class="title">solve</span><span class="params">(ll a,ll pmod)</span></span>{</span><br><span class="line">        a%=pmod;</span><br><span class="line">        cntf=<span class="number">0</span>;</span><br><span class="line">        p=pmod;</span><br><span class="line">        sieves(pmod);</span><br><span class="line">        <span class="keyword">if</span>(cntf&gt;<span class="number">1</span>)sort(fact+<span class="number">1</span>,fact+cntf+<span class="number">1</span>);</span><br><span class="line">        <span class="keyword">if</span>(cntf&gt;<span class="number">1</span>)cntf=unique(fact+<span class="number">1</span>,fact+cntf+<span class="number">1</span>)-fact<span class="number">-1</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> re i=<span class="number">1</span>;i&lt;=cntf;++i){</span><br><span class="line">            re ll now=<span class="number">0</span>,rmod=<span class="number">1</span>;</span><br><span class="line">            <span class="keyword">while</span>(pmod%fact[i]==<span class="number">0</span>)pmod/=fact[i],++now,rmod*=fact[i];</span><br><span class="line">            mod[i]=rmod;</span><br><span class="line">            <span class="keyword">if</span>(fact[i]==<span class="number">2</span>)remain[i]=solve_2k(a,now);</span><br><span class="line">            <span class="keyword">else</span> remain[i]=solve_pk(a,now,fact[i],rmod);</span><br><span class="line">            <span class="keyword">if</span>(remain[i]==<span class="number">-1</span>)<span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">        }</span><br><span class="line">        <span class="keyword">return</span> CRT();</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="meta">#<span class="meta-keyword">undef</span> complex</span></span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> T;</span><br><span class="line"><span class="function"><span class="keyword">signed</span> <span class="title">main</span><span class="params">()</span></span>{</span><br><span class="line">    srand(time(<span class="number">0</span>));</span><br><span class="line">    Linear_sieves::init();</span><br><span class="line">    T=getint();</span><br><span class="line">    <span class="keyword">const</span> ll p = <span class="number">1e9</span>+<span class="number">7</span>;</span><br><span class="line">    <span class="keyword">while</span>(T--){</span><br><span class="line">        re ll b=getint(),c=getint(),ans;</span><br><span class="line">        ans=Find_root::solve(b * b - <span class="number">4</span> * c,<span class="number">4</span>*p);</span><br><span class="line">        <span class="keyword">if</span>(ans == <span class="number">-1</span>){</span><br><span class="line">            b += p;</span><br><span class="line">            ans=Find_root::solve(b * b - <span class="number">4</span> * c,<span class="number">4</span>*p);</span><br><span class="line">            <span class="keyword">if</span>(ans == <span class="number">-1</span>){</span><br><span class="line">                <span class="built_in">printf</span>(<span class="string">"-1 -1\n"</span>);</span><br><span class="line">                <span class="keyword">continue</span>;</span><br><span class="line">            }</span><br><span class="line">        }</span><br><span class="line">        ll x = ans + b;</span><br><span class="line">        x &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">        x %= p;</span><br><span class="line">        ll y = (b - x + p) % p;</span><br><span class="line">        <span class="keyword">if</span>(x &gt; y){</span><br><span class="line">            swap(x, y);</span><br><span class="line">        }</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"%lld %lld\n"</span>, x, y);</span><br><span class="line">    }</span><br><span class="line">    FLUSH();</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<h3 id="1-13-k次幂和"><a href="#1-13-k次幂和" class="headerlink" title="1.13. k次幂和"></a>1.13. k次幂和</h3><figure class="highlight cpp"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdlib&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> P=<span class="number">1000000009</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> INV2=<span class="number">500000005</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> SQRT5=<span class="number">383008016</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> INVSQRT5=<span class="number">276601605</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> A=<span class="number">691504013</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> B=<span class="number">308495997</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N=<span class="number">100005</span>;</span><br><span class="line">ll n,K;</span><br><span class="line">ll fac[N],inv[N];</span><br><span class="line">ll pa[N],pb[N];</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">Pre</span><span class="params">(<span class="keyword">int</span> n)</span></span></span><br><span class="line"><span class="function"></span>{</span><br><span class="line">    fac[<span class="number">0</span>]=<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;i++)</span><br><span class="line">        fac[i]=fac[i<span class="number">-1</span>]*i%P;</span><br><span class="line">    inv[<span class="number">1</span>]=<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">2</span>;i&lt;=n;i++)</span><br><span class="line">        inv[i]=(P-P/i)*inv[P%i]%P;</span><br><span class="line">    inv[<span class="number">0</span>]=<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;i++)</span><br><span class="line">        inv[i]=inv[i]*inv[i<span class="number">-1</span>]%P;</span><br><span class="line">    pa[<span class="number">0</span>]=<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;i++)</span><br><span class="line">        pa[i]=pa[i<span class="number">-1</span>]*A%P;</span><br><span class="line">    pb[<span class="number">0</span>]=<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;i++)</span><br><span class="line">        pb[i]=pb[i<span class="number">-1</span>]*B%P;</span><br><span class="line">}</span><br><span class="line"><span class="function"><span class="keyword">inline</span> ll <span class="title">C</span><span class="params">(<span class="keyword">int</span> n,<span class="keyword">int</span> m)</span></span></span><br><span class="line"><span class="function"></span>{  </span><br><span class="line">    <span class="keyword">return</span> fac[n]*inv[m]%P*inv[n-m]%P;</span><br><span class="line">}</span><br><span class="line"><span class="function"><span class="keyword">inline</span> ll <span class="title">Pow</span><span class="params">(ll a,ll b)</span></span></span><br><span class="line"><span class="function"></span>{  </span><br><span class="line">    ll ret=<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (;b;b&gt;&gt;=<span class="number">1</span>,a=a*a%P)</span><br><span class="line">        <span class="keyword">if</span> (b&amp;<span class="number">1</span>)</span><br><span class="line">            ret=ret*a%P;</span><br><span class="line">        <span class="keyword">return</span> ret;</span><br><span class="line">}</span><br><span class="line"><span class="function"><span class="keyword">inline</span> ll <span class="title">Inv</span><span class="params">(ll x)</span></span></span><br><span class="line"><span class="function"></span>{  </span><br><span class="line">    <span class="keyword">return</span> Pow(x,P<span class="number">-2</span>);</span><br><span class="line">}</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">Solve</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>{  </span><br><span class="line">    ll Ans=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> j=<span class="number">0</span>;j&lt;=K;j++){</span><br><span class="line">        ll t=pa[K-j]*pb[j]%P,tem;</span><br><span class="line">        tem=t==<span class="number">1</span>?n%P:t*(Pow(t,n)<span class="number">-1</span>+P)%P*Inv(t<span class="number">-1</span>)%P;</span><br><span class="line">        <span class="keyword">if</span> (~j&amp;<span class="number">1</span>)</span><br><span class="line">            Ans+=C(K,j)*tem%P,Ans%=P;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            Ans+=P-C(K,j)*tem%P,Ans%=P;</span><br><span class="line">    }</span><br><span class="line">    Ans=Ans*Pow(INVSQRT5,K)%P;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>,Ans);</span><br><span class="line">}</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>{  </span><br><span class="line">    <span class="keyword">int</span> T;</span><br><span class="line">    freopen(<span class="string">"t.in"</span>,<span class="string">"r"</span>,<span class="built_in">stdin</span>);</span><br><span class="line">    freopen(<span class="string">"t.out"</span>,<span class="string">"w"</span>,<span class="built_in">stdout</span>);  </span><br><span class="line">    Pre(<span class="number">100000</span>);</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;T);  </span><br><span class="line">    <span class="keyword">while</span> (T--){</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%lld%lld"</span>,&amp;n,&amp;K);</span><br><span class="line">        Solve();</span><br><span class="line">    }</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<h3 id="1-14-杜教筛"><a href="#1-14-杜教筛" class="headerlink" title="1.14. 杜教筛"></a>1.14. 杜教筛</h3><blockquote>
<p>筛$\mu$和$\varphi$的板子,根据内存来限制先预处理多少</p>
</blockquote>
<figure class="highlight cpp"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;tr1/unordered_map&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> N 6000010</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt;<span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">read</span><span class="params">(T &amp;x)</span></span></span><br><span class="line"><span class="function"></span>{</span><br><span class="line">    x=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">int</span> p;p=<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">char</span> c;c=getchar();</span><br><span class="line">    <span class="keyword">while</span>(!<span class="built_in">isdigit</span>(c)){<span class="keyword">if</span>(c==<span class="string">'-'</span>)p=<span class="number">-1</span>;c=getchar();}</span><br><span class="line">    <span class="keyword">while</span>(<span class="built_in">isdigit</span>(c)) {x=(x&lt;&lt;<span class="number">1</span>)+(x&lt;&lt;<span class="number">3</span>)+(c<span class="number">-48</span>);c=getchar();}</span><br><span class="line">    x*=p;</span><br><span class="line">}</span><br><span class="line"><span class="keyword">bool</span> vis[N];</span><br><span class="line"><span class="keyword">int</span> mu[N],sum1[N],phi[N];</span><br><span class="line"><span class="keyword">long</span> <span class="keyword">long</span> sum2[N];</span><br><span class="line"><span class="keyword">int</span> cnt,prim[N];</span><br><span class="line">tr1::<span class="built_in">unordered_map</span>&lt;<span class="keyword">long</span> <span class="keyword">long</span>,<span class="keyword">long</span> <span class="keyword">long</span>&gt;w1;</span><br><span class="line">tr1::<span class="built_in">unordered_map</span>&lt;<span class="keyword">int</span>,<span class="keyword">int</span>&gt;w;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">get</span><span class="params">(<span class="keyword">int</span> maxn)</span></span></span><br><span class="line"><span class="function"></span>{</span><br><span class="line">    phi[<span class="number">1</span>]=mu[<span class="number">1</span>]=<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">2</span>;i&lt;=maxn;i++)</span><br><span class="line">    {</span><br><span class="line">        <span class="keyword">if</span>(!vis[i])</span><br><span class="line">        {</span><br><span class="line">            prim[++cnt]=i;</span><br><span class="line">            mu[i]=<span class="number">-1</span>;phi[i]=i<span class="number">-1</span>;</span><br><span class="line">        }</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">1</span>;j&lt;=cnt&amp;&amp;prim[j]*i&lt;=maxn;j++)</span><br><span class="line">        {</span><br><span class="line">            vis[i*prim[j]]=<span class="number">1</span>;</span><br><span class="line">            <span class="keyword">if</span>(i%prim[j]==<span class="number">0</span>)</span><br><span class="line">            {</span><br><span class="line">                phi[i*prim[j]]=phi[i]*prim[j];</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            }</span><br><span class="line">            <span class="keyword">else</span> mu[i*prim[j]]=-mu[i],phi[i*prim[j]]=phi[i]*(prim[j]<span class="number">-1</span>);</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=maxn;i++)sum1[i]=sum1[i<span class="number">-1</span>]+mu[i],sum2[i]=sum2[i<span class="number">-1</span>]+phi[i];</span><br><span class="line">}</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">djsmu</span><span class="params">(<span class="keyword">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>{</span><br><span class="line">    <span class="keyword">if</span>(x&lt;=<span class="number">6000000</span>)<span class="keyword">return</span> sum1[x];</span><br><span class="line">    <span class="keyword">if</span>(w[x])<span class="keyword">return</span> w[x];</span><br><span class="line">    <span class="keyword">int</span> ans=<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> l=<span class="number">2</span>,r;l&gt;=<span class="number">0</span>&amp;&amp;l&lt;=x;l=r+<span class="number">1</span>)</span><br><span class="line">    {</span><br><span class="line">        r=x/(x/l);</span><br><span class="line">        ans-=(r-l+<span class="number">1</span>)*djsmu(x/l);</span><br><span class="line">    }</span><br><span class="line">    <span class="keyword">return</span> w[x]=ans;</span><br><span class="line">}</span><br><span class="line"><span class="function"><span class="keyword">long</span> <span class="keyword">long</span> <span class="title">djsphi</span><span class="params">(<span class="keyword">long</span> <span class="keyword">long</span> x)</span></span></span><br><span class="line"><span class="function"></span>{</span><br><span class="line">    <span class="keyword">if</span>(x&lt;=<span class="number">6000000</span>)<span class="keyword">return</span> sum2[x];</span><br><span class="line">    <span class="keyword">if</span>(w1[x])<span class="keyword">return</span> w1[x];</span><br><span class="line">    <span class="keyword">long</span> <span class="keyword">long</span> ans=x*(x+<span class="number">1</span>)/<span class="number">2</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">long</span> <span class="keyword">long</span> l=<span class="number">2</span>,r;l&lt;=x;l=r+<span class="number">1</span>)</span><br><span class="line">    {</span><br><span class="line">        r=x/(x/l);</span><br><span class="line">        ans-=(r-l+<span class="number">1</span>)*djsphi(x/l);</span><br><span class="line">    }</span><br><span class="line">    <span class="keyword">return</span> w1[x]=ans;</span><br><span class="line">}</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>{</span><br><span class="line">    <span class="keyword">int</span> t,n;</span><br><span class="line">    read(t);</span><br><span class="line">    get(<span class="number">6000000</span>);</span><br><span class="line">    <span class="keyword">while</span>(t--)</span><br><span class="line">    {</span><br><span class="line">        read(n);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"%lld %d\n"</span>,djsphi(n),djsmu(n));</span><br><span class="line">    }</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<h2 id="2-数据结构"><a href="#2-数据结构" class="headerlink" title="2. 数据结构"></a>2. 数据结构</h2><h3 id="2-1-kd树"><a href="#2-1-kd树" class="headerlink" title="2.1. kd树"></a>2.1. kd树</h3><blockquote>
<p>x维数为2的KDtree模板</p>
</blockquote>
<figure class="highlight cpp"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> LL;</span><br><span class="line"><span class="keyword">const</span> LL INF = <span class="number">0x3f3f3f3f3f3f3f3f</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">1e5</span> + <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Node</span> {</span></span><br><span class="line">    <span class="keyword">int</span> lson, rson;</span><br><span class="line">    LL Min[<span class="number">2</span>], Max[<span class="number">2</span>], x[<span class="number">2</span>];</span><br><span class="line">    <span class="keyword">int</span> id;</span><br><span class="line">} kdt[MAXN &lt;&lt; <span class="number">1</span>], tmp;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> root, cmp_x;</span><br><span class="line">LL ans, xx0, xx1;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">cmp</span> <span class="params">(<span class="keyword">const</span> Node &amp;a, <span class="keyword">const</span> Node &amp;b)</span> </span>{</span><br><span class="line">    <span class="keyword">return</span> a.x[cmp_x] &lt; b.x[cmp_x] || (a.x[cmp_x] == b.x[cmp_x] &amp;&amp; a.x[cmp_x^<span class="number">1</span>] &lt; b.x[cmp_x^<span class="number">1</span>]);</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="comment">// 更新每个结点的边界信息</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">pushUp</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> v)</span> </span>{</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">2</span>; i++) kdt[u].Min[i] = min(kdt[u].Min[i], kdt[v].Min[i]);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">2</span>; i++) kdt[u].Max[i] = max(kdt[u].Max[i], kdt[v].Max[i]);</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">kdtBuild</span><span class="params">(<span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span> X)</span> </span>{</span><br><span class="line">    <span class="keyword">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">    kdt[mid].lson = kdt[mid].rson = <span class="number">0</span>;</span><br><span class="line">    cmp_x = X;</span><br><span class="line">    nth_element(kdt + l + <span class="number">1</span>, kdt + mid + <span class="number">1</span>, kdt + r + <span class="number">1</span>, cmp); <span class="comment">// 将编号为mid的元素放在中间，比它小的放在前面，比它大的放后面</span></span><br><span class="line">    kdt[mid].Min[<span class="number">0</span>] = kdt[mid].Max[<span class="number">0</span>] = kdt[mid].x[<span class="number">0</span>];</span><br><span class="line">    kdt[mid].Min[<span class="number">1</span>] = kdt[mid].Max[<span class="number">1</span>] = kdt[mid].x[<span class="number">1</span>];</span><br><span class="line">    <span class="keyword">if</span> (l != mid) kdt[mid].lson = kdtBuild(l, mid - <span class="number">1</span>, X ^ <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">if</span> (r != mid) kdt[mid].rson = kdtBuild(mid + <span class="number">1</span>, r, X ^ <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">if</span> (kdt[mid].lson) pushUp(mid, kdt[mid].lson);</span><br><span class="line">    <span class="keyword">if</span> (kdt[mid].rson) pushUp(mid, kdt[mid].rson);</span><br><span class="line">    <span class="keyword">return</span> mid;</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="comment">// 插入新的结点</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">kdtInsert</span><span class="params">(<span class="keyword">int</span> now)</span> </span>{</span><br><span class="line">    <span class="keyword">int</span> X = <span class="number">0</span>, p = root;</span><br><span class="line">    <span class="keyword">while</span> (<span class="literal">true</span>) {</span><br><span class="line">        pushUp(p, now);</span><br><span class="line">        <span class="keyword">if</span> (kdt[now].x[X] &lt; kdt[p].x[X]) {</span><br><span class="line">            <span class="keyword">if</span> (!kdt[p].lson) {</span><br><span class="line">                kdt[p].lson = now;</span><br><span class="line">                <span class="keyword">return</span>;</span><br><span class="line">            }</span><br><span class="line">            <span class="keyword">else</span> p = kdt[p].lson;</span><br><span class="line">        }</span><br><span class="line">        <span class="keyword">else</span> {</span><br><span class="line">            <span class="keyword">if</span> (!kdt[p].rson) {</span><br><span class="line">                kdt[p].rson = now;</span><br><span class="line">                <span class="keyword">return</span>;</span><br><span class="line">            }</span><br><span class="line">            <span class="keyword">else</span> p = kdt[p].rson;</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="comment">// 点(x,y)在结点id的边界范围内能得到的最大距离上界</span></span><br><span class="line"><span class="function">LL <span class="title">getMaxDis</span><span class="params">(<span class="keyword">int</span> id, LL x0, LL x1)</span> </span>{</span><br><span class="line">    LL res = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">if</span> (x0 &lt; kdt[id].Min[<span class="number">0</span>]) res += (kdt[id].Min[<span class="number">0</span>] - x0) * (kdt[id].Min[<span class="number">0</span>] - x0);</span><br><span class="line">    <span class="keyword">if</span> (x0 &gt; kdt[id].Max[<span class="number">0</span>]) res += (kdt[id].Max[<span class="number">0</span>] - x0) * (kdt[id].Max[<span class="number">0</span>] - x0);</span><br><span class="line">    <span class="keyword">if</span> (x1 &lt; kdt[id].Min[<span class="number">1</span>]) res += (kdt[id].Min[<span class="number">1</span>] - x1) * (kdt[id].Min[<span class="number">1</span>] - x1);</span><br><span class="line">    <span class="keyword">if</span> (x1 &gt; kdt[id].Max[<span class="number">1</span>]) res += (kdt[id].Max[<span class="number">1</span>] - x1) * (kdt[id].Max[<span class="number">1</span>] - x1);</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="function">LL <span class="title">dist</span><span class="params">(<span class="keyword">int</span> id, LL x0, LL x1)</span> </span>{</span><br><span class="line">    <span class="keyword">return</span> (kdt[id].x[<span class="number">0</span>] - x0) * (kdt[id].x[<span class="number">0</span>] - x0) + (kdt[id].x[<span class="number">1</span>] - x1) * (kdt[id].x[<span class="number">1</span>] - x1);</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">kdtQuery</span><span class="params">(<span class="keyword">int</span> p)</span> </span>{</span><br><span class="line">    LL dl = INF, dr = INF, d;</span><br><span class="line">    d = dist(p, xx0, xx1);</span><br><span class="line">    <span class="keyword">if</span> (kdt[p].x[<span class="number">0</span>] == xx0 &amp;&amp; kdt[p].x[<span class="number">1</span>] == xx1) d = INF;  <span class="comment">// 查询(x,y)时要将(x,y)到自己的距离设为INF</span></span><br><span class="line">    ans = min(ans, d);</span><br><span class="line">    <span class="keyword">if</span> (kdt[p].lson) dl = getMaxDis(kdt[p].lson, xx0, xx1);</span><br><span class="line">    <span class="keyword">if</span> (kdt[p].rson) dr = getMaxDis(kdt[p].rson, xx0, xx1);</span><br><span class="line">    <span class="keyword">if</span> (dl &lt; dr) {</span><br><span class="line">        <span class="keyword">if</span> (dl &lt; ans) kdtQuery(kdt[p].lson);</span><br><span class="line">        <span class="keyword">if</span> (dr &lt; ans) kdtQuery(kdt[p].rson);</span><br><span class="line">    }</span><br><span class="line">    <span class="keyword">else</span> {</span><br><span class="line">        <span class="keyword">if</span> (dr &lt; ans) kdtQuery(kdt[p].rson);</span><br><span class="line">        <span class="keyword">if</span> (dl &lt; ans) kdtQuery(kdt[p].lson);</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line">LL answer[MAXN];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>{</span><br><span class="line">    <span class="comment">//freopen("in.txt", "r", stdin);</span></span><br><span class="line">    <span class="keyword">int</span> T;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;T);</span><br><span class="line">    <span class="keyword">while</span> (T--) {</span><br><span class="line">        <span class="keyword">int</span> n;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;n);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) {</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">"%I64d%I64d"</span>, &amp;kdt[i].x[<span class="number">0</span>], &amp;kdt[i].x[<span class="number">1</span>]);</span><br><span class="line">            kdt[i].id = i;</span><br><span class="line">        }</span><br><span class="line">        root = kdtBuild(<span class="number">1</span>, n, <span class="number">0</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) {</span><br><span class="line">            ans = INF;</span><br><span class="line">            xx0 = kdt[i].x[<span class="number">0</span>]; xx1 = kdt[i].x[<span class="number">1</span>];</span><br><span class="line">            kdtQuery(root);</span><br><span class="line">            answer[kdt[i].id] = ans;</span><br><span class="line">           <span class="comment">// printf("---%d\n", ans);</span></span><br><span class="line">        }</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++)</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">"%I64d\n"</span>, answer[i]);</span><br><span class="line">    }</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<h2 id="3-dp"><a href="#3-dp" class="headerlink" title="3. dp"></a>3. dp</h2><h3 id="3-1-区间dp"><a href="#3-1-区间dp" class="headerlink" title="3.1. 区间dp"></a>3.1. 区间dp</h3><figure class="highlight cpp"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;queue&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> mst(a,b) memset((a),(b),sizeof(a))</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rush() int T;scanf(<span class="meta-string">"%d"</span>,&amp;T);while(T--)</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxn = <span class="number">205</span>;</span><br><span class="line"><span class="keyword">const</span> ll mod = <span class="number">1e9</span>+<span class="number">7</span>;</span><br><span class="line"><span class="keyword">const</span> ll INF = <span class="number">1e18</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">double</span> eps = <span class="number">1e-9</span>;</span><br><span class="line"><span class="keyword">int</span> n,x;</span><br><span class="line"><span class="keyword">int</span> sum[maxn];</span><br><span class="line"><span class="keyword">int</span> dp[maxn][maxn];</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>{</span><br><span class="line">    <span class="keyword">while</span>(~<span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;n))</span><br><span class="line">    {</span><br><span class="line">        sum[<span class="number">0</span>]=<span class="number">0</span>;</span><br><span class="line">        mst(dp,<span class="number">0x3f</span>);</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;i++)</span><br><span class="line">        {</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;x);</span><br><span class="line">            sum[i]=sum[i<span class="number">-1</span>]+x;</span><br><span class="line">            dp[i][i]=<span class="number">0</span>;</span><br><span class="line">        }</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> len=<span class="number">2</span>;len&lt;=n;len++)</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;i++)</span><br><span class="line">        {</span><br><span class="line">            <span class="keyword">int</span> j=i+len<span class="number">-1</span>;</span><br><span class="line">            <span class="keyword">if</span>(j&gt;n) <span class="keyword">continue</span>;</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> k=i;k&lt;j;k++)</span><br><span class="line">            {</span><br><span class="line">                dp[i][j]=min(dp[i][j],dp[i][k]+dp[k+<span class="number">1</span>][j]+sum[j]-sum[i<span class="number">-1</span>]);</span><br><span class="line">            }</span><br><span class="line">        }</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"%d\n"</span>,dp[<span class="number">1</span>][n]);</span><br><span class="line">    }</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<h3 id="3-2-状压dp"><a href="#3-2-状压dp" class="headerlink" title="3.2. 状压dp"></a>3.2. 状压dp</h3><figure class="highlight cpp"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;queue&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">RD</span><span class="params">()</span></span>{</span><br><span class="line">    <span class="keyword">int</span> out = <span class="number">0</span>,flag = <span class="number">1</span>;<span class="keyword">char</span> c = getchar();</span><br><span class="line">    <span class="keyword">while</span>(c &lt; <span class="string">'0'</span> || c &gt;<span class="string">'9'</span>){<span class="keyword">if</span>(c == <span class="string">'-'</span>)flag = <span class="number">-1</span>;c = getchar();}</span><br><span class="line">    <span class="keyword">while</span>(c &gt;= <span class="string">'0'</span> &amp;&amp; c &lt;= <span class="string">'9'</span>){out = out * <span class="number">10</span> + c - <span class="string">'0'</span>;c = getchar();}</span><br><span class="line">    <span class="keyword">return</span> flag * out;</span><br><span class="line">    }</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxn = <span class="number">2048</span>;</span><br><span class="line"><span class="keyword">int</span> num,m,numd;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Node</span>{</span></span><br><span class="line">    <span class="keyword">int</span> dp,step;</span><br><span class="line">    };</span><br><span class="line"><span class="keyword">int</span> vis[maxn];</span><br><span class="line"><span class="keyword">int</span> <span class="built_in">map</span>[maxn][maxn];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">BFS</span><span class="params">(<span class="keyword">int</span> n)</span></span>{</span><br><span class="line">    <span class="built_in">queue</span>&lt;Node&gt;Q;</span><br><span class="line">    Node fir;fir.step = <span class="number">0</span>,fir.dp = n;<span class="comment">//初始状态入队</span></span><br><span class="line">    Q.push(fir);</span><br><span class="line">    <span class="keyword">while</span>(!Q.empty()){<span class="comment">//BFS</span></span><br><span class="line">        Node u = Q.front();</span><br><span class="line">        Q.pop();</span><br><span class="line">        <span class="keyword">int</span> pre = u.dp;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= m;i++){<span class="comment">//枚举每个操作</span></span><br><span class="line">            <span class="keyword">int</span> now = pre;</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">1</span>;j &lt;= num;j++){</span><br><span class="line">                <span class="keyword">if</span>(<span class="built_in">map</span>[i][j] == <span class="number">1</span>){</span><br><span class="line">                    <span class="keyword">if</span>( (<span class="number">1</span> &lt;&lt; (j - <span class="number">1</span>)) &amp; now){</span><br><span class="line">                        now = now ^ (<span class="number">1</span> &lt;&lt; (j - <span class="number">1</span>));<span class="comment">//对状态进行操作</span></span><br><span class="line">                        }</span><br><span class="line">                    }</span><br><span class="line">                <span class="keyword">else</span> <span class="keyword">if</span>(<span class="built_in">map</span>[i][j] == <span class="number">-1</span>){</span><br><span class="line">                    now = ( (<span class="number">1</span> &lt;&lt; (j - <span class="number">1</span>) ) | now);<span class="comment">//对状态进行操作</span></span><br><span class="line">                    }</span><br><span class="line">                }</span><br><span class="line">            fir.dp = now,fir.step = u.step + <span class="number">1</span>;<span class="comment">//记录步数</span></span><br><span class="line">            <span class="keyword">if</span>(vis[now] == <span class="literal">true</span>){</span><br><span class="line">                <span class="keyword">continue</span>;</span><br><span class="line">                }</span><br><span class="line">            <span class="keyword">if</span>(fir.dp == <span class="number">0</span>){<span class="comment">//达到目标状态</span></span><br><span class="line">                vis[<span class="number">0</span>] = <span class="literal">true</span>;<span class="comment">//相当于一个标记flag</span></span><br><span class="line">                <span class="built_in">cout</span>&lt;&lt;fir.step&lt;&lt;<span class="built_in">endl</span>;<span class="comment">//输出</span></span><br><span class="line">                <span class="keyword">return</span> ;<span class="comment">//退出函数</span></span><br><span class="line">                }</span><br><span class="line">            Q.push(fir);<span class="comment">//新状态入队</span></span><br><span class="line">            vis[now] = <span class="literal">true</span>;<span class="comment">//表示这个状态操作过了（以后在有这个状态就不用试了）</span></span><br><span class="line">            }</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>{</span><br><span class="line">    num = RD();m = RD();</span><br><span class="line">    <span class="keyword">int</span> n = (<span class="number">1</span> &lt;&lt; (num)) - <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= m;i++){</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">1</span>;j &lt;= num;j++){</span><br><span class="line">            <span class="built_in">map</span>[i][j] = RD();</span><br><span class="line">            }</span><br><span class="line">        }</span><br><span class="line">    BFS(n);</span><br><span class="line">    <span class="keyword">if</span>(vis[<span class="number">0</span>] == <span class="literal">false</span>)</span><br><span class="line">        <span class="built_in">cout</span>&lt;&lt;<span class="number">-1</span>&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<h3 id="3-3-数位dp"><a href="#3-3-数位dp" class="headerlink" title="3.3. 数位dp"></a>3.3. 数位dp</h3><figure class="highlight cpp"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;  </span><br><span class="line"><span class="keyword">int</span> a[<span class="number">20</span>];  </span><br><span class="line">ll dp[<span class="number">20</span>][state];<span class="comment">//不同题目状态不同</span></span><br><span class="line"><span class="function">ll <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> pos,<span class="comment">/*state变量*/</span>,<span class="keyword">bool</span> lead<span class="comment">/*前导零*/</span>,<span class="keyword">bool</span> limit<span class="comment">/*数位上界变量*/</span>)</span><span class="comment">//不是每个题都要判断前导零  </span></span></span><br><span class="line"><span class="function"></span>{  </span><br><span class="line">    <span class="comment">//递归边界，既然是按位枚举，最低位是0，那么pos==-1说明这个数我枚举完了  </span></span><br><span class="line">    <span class="keyword">if</span>(pos==<span class="number">-1</span>) <span class="keyword">return</span> <span class="number">1</span>;<span class="comment">/*这里一般返回1，表示你枚举的这个数是合法的，那么这里就需要你在枚举时必须每一位都要满足题目条件，也就是说当前枚举到pos位，一定要保证前面已经枚举的数位是合法的。不过具体题目不同或者写法不同的话不一定要返回1 */</span>  </span><br><span class="line">    <span class="comment">//第二个就是记忆化(在此前可能不同题目还能有一些剪枝)  </span></span><br><span class="line">    <span class="keyword">if</span>(!limit &amp;&amp; !lead &amp;&amp; dp[pos][state]!=<span class="number">-1</span>) <span class="keyword">return</span> dp[pos][state];  </span><br><span class="line">    <span class="comment">/*常规写法都是在没有限制的条件记忆化，这里与下面记录状态是对应，具体为什么是有条件的记忆化后面会讲*/</span>  </span><br><span class="line">    <span class="keyword">int</span> up=limit?a[pos]:<span class="number">9</span>;<span class="comment">//根据limit判断枚举的上界up;这个的例子前面用213讲过了  </span></span><br><span class="line">    ll ans=<span class="number">0</span>;  </span><br><span class="line">    <span class="comment">//开始计数  </span></span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;=up;i++)<span class="comment">//枚举，然后把不同情况的个数加到ans就可以了  </span></span><br><span class="line">    {  </span><br><span class="line">        <span class="keyword">if</span>() ...  </span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span>()...  </span><br><span class="line">        ans+=dfs(pos<span class="number">-1</span>,<span class="comment">/*状态转移*/</span>,lead &amp;&amp; i==<span class="number">0</span>,limit &amp;&amp; i==a[pos]) <span class="comment">//最后两个变量传参都是这样写的  </span></span><br><span class="line">        <span class="comment">/*这里还算比较灵活，不过做几个题就觉得这里也是套路了</span></span><br><span class="line"><span class="comment">        大概就是说，我当前数位枚举的数是i，然后根据题目的约束条件分类讨论</span></span><br><span class="line"><span class="comment">        去计算不同情况下的个数，还有要根据state变量来保证i的合法性，比如题目</span></span><br><span class="line"><span class="comment">        要求数位上不能有62连续出现,那么就是state就是要保存前一位pre,然后分类，</span></span><br><span class="line"><span class="comment">            前一位如果是6那么这意味就不能是2，这里一定要保存枚举的这个数是合法*/</span>  </span><br><span class="line">    }  </span><br><span class="line">    <span class="comment">//计算完，记录状态  </span></span><br><span class="line">    <span class="keyword">if</span>(!limit &amp;&amp; !lead) dp[pos][state]=ans;  </span><br><span class="line">    <span class="comment">/*这里对应上面的记忆化，在一定条件下时记录，保证一致性，当然如果约束条件不需要考虑lead，这里就是lead就完全不用考虑了*/</span>  </span><br><span class="line">    <span class="keyword">return</span> ans;  </span><br><span class="line">}  </span><br><span class="line"><span class="function">ll <span class="title">solve</span><span class="params">(ll x)</span>  </span></span><br><span class="line"><span class="function"></span>{  </span><br><span class="line">    <span class="keyword">int</span> pos=<span class="number">0</span>;  </span><br><span class="line">    <span class="keyword">while</span>(x)<span class="comment">//把数位都分解出来  </span></span><br><span class="line">    {  </span><br><span class="line">        a[pos++]=x%<span class="number">10</span>;<span class="comment">//个人老是喜欢编号为[0,pos),看不惯的就按自己习惯来，反正注意数位边界就行  </span></span><br><span class="line">        x/=<span class="number">10</span>;  </span><br><span class="line">    }  </span><br><span class="line">    <span class="keyword">return</span> dfs(pos<span class="number">-1</span><span class="comment">/*从最高位开始枚举*/</span>,<span class="comment">/*一系列状态 */</span>,<span class="literal">true</span>,<span class="literal">true</span>);<span class="comment">//刚开始最高位都是有限制并且有前导零的，显然比最高位还要高的一位视为0嘛  </span></span><br><span class="line">}  </span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span>  </span></span><br><span class="line"><span class="function"></span>{  </span><br><span class="line">    ll le,ri;  </span><br><span class="line">    <span class="keyword">while</span>(~<span class="built_in">scanf</span>(<span class="string">"%lld%lld"</span>,&amp;le,&amp;ri))  </span><br><span class="line">    {  </span><br><span class="line">        <span class="comment">//初始化dp数组为-1,这里还有更加优美的优化,后面讲  </span></span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>,solve(ri)-solve(le<span class="number">-1</span>));  </span><br><span class="line">    }  </span><br><span class="line">}  </span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure>
<figure class="highlight cpp"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdlib&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cmath&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;map&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="keyword">int</span> a[<span class="number">20</span>];</span><br><span class="line">ll dp[<span class="number">20</span>][<span class="number">2</span>];</span><br><span class="line"><span class="function">ll <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> pos, <span class="keyword">int</span> pre, <span class="keyword">int</span> state, <span class="keyword">bool</span> limit)</span><span class="comment">//不是每个题都要判断前导零</span></span></span><br><span class="line"><span class="function"></span>{</span><br><span class="line">    <span class="keyword">if</span>(pos==<span class="number">-1</span>) <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span>(!limit &amp;&amp; dp[pos][state]!=<span class="number">-1</span>) <span class="keyword">return</span> dp[pos][state];</span><br><span class="line">    <span class="keyword">int</span> up=limit?a[pos]:<span class="number">9</span>;</span><br><span class="line">    ll ans=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;=up;i++)</span><br><span class="line">    {</span><br><span class="line">        <span class="keyword">if</span>(i == <span class="number">4</span>) <span class="keyword">continue</span>;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(pre == <span class="number">6</span> &amp;&amp; i == <span class="number">2</span>) <span class="keyword">continue</span>;</span><br><span class="line">        ans+=dfs(pos<span class="number">-1</span>, i, i == <span class="number">6</span> ? <span class="number">1</span> : <span class="number">0</span>, limit &amp;&amp; i==a[pos]);</span><br><span class="line">    }</span><br><span class="line">    <span class="keyword">if</span>(!limit) dp[pos][state]=ans;</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">}</span><br><span class="line"><span class="function">ll <span class="title">solve</span><span class="params">(ll x)</span></span></span><br><span class="line"><span class="function"></span>{</span><br><span class="line">    <span class="keyword">int</span> pos=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(x)</span><br><span class="line">    {</span><br><span class="line">        a[pos++]=x%<span class="number">10</span>;</span><br><span class="line">        x/=<span class="number">10</span>;</span><br><span class="line">    }</span><br><span class="line">    <span class="keyword">return</span> dfs(pos - <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="literal">true</span>);</span><br><span class="line">}</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>{</span><br><span class="line">    ll le,ri;</span><br><span class="line">    <span class="keyword">while</span>(~<span class="built_in">scanf</span>(<span class="string">"%lld%lld"</span>,&amp;le,&amp;ri) &amp;&amp; (le || ri))</span><br><span class="line">    {</span><br><span class="line">        <span class="built_in">memset</span>(dp, <span class="number">-1</span>, <span class="keyword">sizeof</span>(dp));</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>,solve(ri)-solve(le<span class="number">-1</span>));</span><br><span class="line">    }</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<h2 id="4-计算几何"><a href="#4-计算几何" class="headerlink" title="4. 计算几何"></a>4. 计算几何</h2><h3 id="4-1-红书"><a href="#4-1-红书" class="headerlink" title="4.1. 红书"></a>4.1. 红书</h3><h3 id="4-2-三维向量旋转"><a href="#4-2-三维向量旋转" class="headerlink" title="4.2. 三维向量旋转"></a>4.2. 三维向量旋转</h3><figure class="highlight cpp"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> eps 1e-10</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> pi acos(-1.0)</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">dcmp</span><span class="params">(<span class="keyword">double</span> x)</span></span>{<span class="keyword">if</span> (<span class="built_in">fabs</span>(x)&lt;eps)<span class="keyword">return</span> <span class="number">0</span>;<span class="keyword">else</span> <span class="keyword">return</span> x&lt;<span class="number">0</span>?<span class="number">-1</span>:<span class="number">1</span>;}</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Point3</span></span></span><br><span class="line"><span class="class">{</span></span><br><span class="line">    <span class="keyword">double</span> x,y,z;</span><br><span class="line">    Point3(<span class="keyword">double</span> x=<span class="number">0</span>,<span class="keyword">double</span> y=<span class="number">0</span>,<span class="keyword">double</span> z=<span class="number">0</span>):x(x),y(y),z(z){};</span><br><span class="line">};</span><br><span class="line"><span class="keyword">typedef</span> Point3 Vector3;</span><br><span class="line">Vector3 <span class="keyword">operator</span> + (Vector3 a,Vector3 b){<span class="keyword">return</span> Vector3(a.x+b.x,a.y+b.y,a.z+b.z);}</span><br><span class="line">Vector3 <span class="keyword">operator</span> - (Vector3 a,Vector3 b){<span class="keyword">return</span> Vector3(a.x-b.x,a.y-b.y,a.z-b.z);}</span><br><span class="line">Vector3 <span class="keyword">operator</span> * (Vector3 a,<span class="keyword">double</span> b){<span class="keyword">return</span> Vector3(a.x*b,a.y*b,a.z*b);}</span><br><span class="line">Vector3 <span class="keyword">operator</span> / (Vector3 a,<span class="keyword">double</span> b){<span class="keyword">return</span> Vector3(a.x/b,a.y/b,a.z/b);}</span><br><span class="line"><span class="keyword">bool</span> <span class="keyword">operator</span> == (Vector3 a,Vector3 b){<span class="keyword">return</span> a.x==b.x &amp;&amp; a.y==b.y &amp;&amp; a.z==b.z;}</span><br><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">Dot3</span><span class="params">(Vector3 a,Vector3 b)</span></span>{<span class="keyword">return</span> a.x*b.x+a.y*b.y+a.z*b.z;}  <span class="comment">//点积</span></span><br><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">Length3</span><span class="params">(Vector3 a)</span></span>{<span class="keyword">return</span> <span class="built_in">sqrt</span>(Dot3(a,a));}</span><br><span class="line"><span class="function">Vector3 <span class="title">Cross3</span><span class="params">(Vector3 a,Vector3 b)</span> <span class="comment">//叉积</span></span></span><br><span class="line"><span class="function"></span>{<span class="keyword">return</span> Vector3(a.y*b.z-a.z*b.y,a.z*b.x-a.x*b.z,a.x*b.y-a.y*b.x);}</span><br><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">Angle3</span><span class="params">(Vector3 a,Vector3 b)</span></span>{<span class="keyword">return</span> <span class="built_in">acos</span>(Dot3(a,b)/Length3(a)/Length3(b));}<span class="comment">// 范围[0,180]</span></span><br><span class="line"><span class="comment">//点到线段的距离</span></span><br><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">DistanceToSeg3</span><span class="params">(Point3 p,Point3 a,Point3 b)</span></span></span><br><span class="line"><span class="function"></span>{</span><br><span class="line">    <span class="keyword">if</span>(a==b) <span class="keyword">return</span> Length3(p-a);</span><br><span class="line">    Vector3 v1=b-a,v2=p-a,v3=p-b;</span><br><span class="line">    <span class="keyword">if</span>(dcmp(Dot3(v1,v2))&lt;<span class="number">0</span>) <span class="keyword">return</span> Length3(v2);</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span>(dcmp(Dot3(v1,v3))&gt;<span class="number">0</span>) <span class="keyword">return</span> Length3(v3);</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">return</span> Length3(Cross3(v1,v2))/Length3(v1);</span><br><span class="line">}</span><br><span class="line"><span class="comment">//点p绕向量ov旋转ang角度，旋转方向是向量ov叉乘向量op</span></span><br><span class="line"><span class="function">Point3 <span class="title">rotate3</span><span class="params">(Point3 p,Vector3 v,<span class="keyword">double</span> ang)</span></span></span><br><span class="line"><span class="function"></span>{</span><br><span class="line">    <span class="keyword">double</span> ret[<span class="number">3</span>][<span class="number">3</span>],a[<span class="number">3</span>];</span><br><span class="line">    v = v / Length3(v);</span><br><span class="line">    ret[<span class="number">0</span>][<span class="number">0</span>] = (<span class="number">1.0</span> - <span class="built_in">cos</span>(ang)) * v.x * v.x + <span class="built_in">cos</span>(ang);</span><br><span class="line">    ret[<span class="number">0</span>][<span class="number">1</span>] = (<span class="number">1.0</span> - <span class="built_in">cos</span>(ang)) * v.x * v.y - <span class="built_in">sin</span>(ang) * v.z;</span><br><span class="line">    ret[<span class="number">0</span>][<span class="number">2</span>] = (<span class="number">1.0</span> - <span class="built_in">cos</span>(ang)) * v.x * v.z + <span class="built_in">sin</span>(ang) * v.y;</span><br><span class="line">    ret[<span class="number">1</span>][<span class="number">0</span>] = (<span class="number">1.0</span> - <span class="built_in">cos</span>(ang)) * v.y * v.x + <span class="built_in">sin</span>(ang) * v.z;</span><br><span class="line">    ret[<span class="number">1</span>][<span class="number">1</span>] = (<span class="number">1.0</span> - <span class="built_in">cos</span>(ang)) * v.y * v.y + <span class="built_in">cos</span>(ang);</span><br><span class="line">    ret[<span class="number">1</span>][<span class="number">2</span>] = (<span class="number">1.0</span> - <span class="built_in">cos</span>(ang)) * v.y * v.z - <span class="built_in">sin</span>(ang) * v.x;</span><br><span class="line">    ret[<span class="number">2</span>][<span class="number">0</span>] = (<span class="number">1.0</span> - <span class="built_in">cos</span>(ang)) * v.z * v.x - <span class="built_in">sin</span>(ang) * v.y;</span><br><span class="line">    ret[<span class="number">2</span>][<span class="number">1</span>] = (<span class="number">1.0</span> - <span class="built_in">cos</span>(ang)) * v.z * v.y + <span class="built_in">sin</span>(ang) * v.x;</span><br><span class="line">    ret[<span class="number">2</span>][<span class="number">2</span>] = (<span class="number">1.0</span> - <span class="built_in">cos</span>(ang)) * v.z * v.z + <span class="built_in">cos</span>(ang);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;<span class="number">3</span>;i++) a[i]=ret[i][<span class="number">0</span>]*p.x+ret[i][<span class="number">1</span>]*p.y+ret[i][<span class="number">2</span>]*p.z;</span><br><span class="line">    <span class="keyword">return</span> Point3(a[<span class="number">0</span>],a[<span class="number">1</span>],a[<span class="number">2</span>]);</span><br><span class="line">}</span><br><span class="line">Point3 face,head,st,en,a,vx=Point3(<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>),vy=Point3(<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>),vz=Point3(<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>);</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>{</span><br><span class="line">    <span class="keyword">int</span> T,n;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;T);</span><br><span class="line">    <span class="keyword">while</span> (T--)</span><br><span class="line">    {</span><br><span class="line">        <span class="keyword">double</span> ans=<span class="number">1e8</span>,ang,dx,dy,dz,d; <span class="keyword">char</span> x[<span class="number">3</span>];</span><br><span class="line">        face=Point3(<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>); head=Point3(<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>);</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%lf%lf%lf"</span>,&amp;st.x,&amp;st.y,&amp;st.z);</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%lf%lf%lf"</span>,&amp;en.x,&amp;en.y,&amp;en.z);</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;n);</span><br><span class="line">        <span class="keyword">while</span> (n--)</span><br><span class="line">        {</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">"%lf %s %lf"</span>,&amp;d,x,&amp;ang);</span><br><span class="line">            dx=d*<span class="built_in">cos</span>(Angle3(vx,face));</span><br><span class="line">            dy=d*<span class="built_in">cos</span>(Angle3(vy,face));</span><br><span class="line">            dz=d*<span class="built_in">cos</span>(Angle3(vz,face));</span><br><span class="line">            a=st+Point3(dx,dy,dz);</span><br><span class="line">            ans=min(ans,DistanceToSeg3(en,st,a));</span><br><span class="line">            st=a;</span><br><span class="line">            <span class="keyword">if</span> (x[<span class="number">0</span>]==<span class="string">'U'</span>)</span><br><span class="line">            {</span><br><span class="line">                Vector3 v=Cross3(face,head);</span><br><span class="line">                face=rotate3(face,v,ang);</span><br><span class="line">                head=rotate3(head,v,ang);</span><br><span class="line">            }<span class="keyword">else</span></span><br><span class="line">            <span class="keyword">if</span> (x[<span class="number">0</span>]==<span class="string">'D'</span>)</span><br><span class="line">            {</span><br><span class="line">                Vector3 v=Cross3(head,face);</span><br><span class="line">                face=rotate3(face,v,ang);</span><br><span class="line">                head=rotate3(head,v,ang);</span><br><span class="line">            }<span class="keyword">else</span></span><br><span class="line">            <span class="keyword">if</span> (x[<span class="number">0</span>]==<span class="string">'L'</span>)</span><br><span class="line">            {</span><br><span class="line">                face=rotate3(face,head,ang);</span><br><span class="line">            }<span class="keyword">else</span></span><br><span class="line">            <span class="keyword">if</span> (x[<span class="number">0</span>]==<span class="string">'R'</span>)</span><br><span class="line">            {</span><br><span class="line">                Vector3 v=head*(<span class="number">-1</span>);</span><br><span class="line">                face=rotate3(face,v,ang);</span><br><span class="line">            }</span><br><span class="line">        }</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"%.2f\n"</span>,ans);</span><br><span class="line">    }</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<h2 id="5-博弈"><a href="#5-博弈" class="headerlink" title="5. 博弈"></a>5. 博弈</h2><h2 id="6-图论"><a href="#6-图论" class="headerlink" title="6. 图论"></a>6. 图论</h2><h2 id="7-黑科技"><a href="#7-黑科技" class="headerlink" title="7. 黑科技"></a>7. 黑科技</h2><h3 id="7-1-高精"><a href="#7-1-高精" class="headerlink" title="7.1. 高精"></a>7.1. 高精</h3><figure class="highlight cpp"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Wint</span>:</span><span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;</span><br><span class="line">{</span><br><span class="line">    Wint(<span class="keyword">int</span> n=<span class="number">0</span>)</span><br><span class="line">    {</span><br><span class="line">        push_back(n);</span><br><span class="line">        check();</span><br><span class="line">    }</span><br><span class="line">    <span class="function">Wint&amp; <span class="title">check</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>{</span><br><span class="line">        <span class="keyword">while</span>(!empty()&amp;&amp;!back())pop_back();</span><br><span class="line">        <span class="keyword">if</span>(empty())<span class="keyword">return</span> *<span class="keyword">this</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>; i&lt;size(); ++i)</span><br><span class="line">        {</span><br><span class="line">            (*<span class="keyword">this</span>)[i]+=(*<span class="keyword">this</span>)[i<span class="number">-1</span>]/<span class="number">10</span>;</span><br><span class="line">            (*<span class="keyword">this</span>)[i<span class="number">-1</span>]%=<span class="number">10</span>;</span><br><span class="line">        }</span><br><span class="line">        <span class="keyword">while</span>(back()&gt;=<span class="number">10</span>)</span><br><span class="line">        {</span><br><span class="line">            push_back(back()/<span class="number">10</span>);</span><br><span class="line">            (*<span class="keyword">this</span>)[size()<span class="number">-2</span>]%=<span class="number">10</span>;</span><br><span class="line">        }</span><br><span class="line">        <span class="keyword">return</span> *<span class="keyword">this</span>;</span><br><span class="line">    }</span><br><span class="line">};</span><br><span class="line">istream&amp; <span class="keyword">operator</span>&gt;&gt;(istream &amp;is,Wint &amp;n)</span><br><span class="line">{</span><br><span class="line">    <span class="built_in">string</span> s;</span><br><span class="line">    is&gt;&gt;s;</span><br><span class="line">    n.clear();</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=s.size()<span class="number">-1</span>; i&gt;=<span class="number">0</span>; --i)n.push_back(s[i]-<span class="string">'0'</span>);</span><br><span class="line">    <span class="keyword">return</span> is;</span><br><span class="line">}</span><br><span class="line">ostream&amp; <span class="keyword">operator</span>&lt;&lt;(ostream &amp;os,<span class="keyword">const</span> Wint &amp;n)</span><br><span class="line">{</span><br><span class="line">    <span class="keyword">if</span>(n.empty())os&lt;&lt;<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=n.size()<span class="number">-1</span>; i&gt;=<span class="number">0</span>; --i)os&lt;&lt;n[i];</span><br><span class="line">    <span class="keyword">return</span> os;</span><br><span class="line">}</span><br><span class="line"><span class="keyword">bool</span> <span class="keyword">operator</span>!=(<span class="keyword">const</span> Wint &amp;a,<span class="keyword">const</span> Wint &amp;b)</span><br><span class="line">{</span><br><span class="line">    <span class="keyword">if</span>(a.size()!=b.size())<span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=a.size()<span class="number">-1</span>; i&gt;=<span class="number">0</span>; --i)</span><br><span class="line">        <span class="keyword">if</span>(a[i]!=b[i])<span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">}</span><br><span class="line"><span class="keyword">bool</span> <span class="keyword">operator</span>==(<span class="keyword">const</span> Wint &amp;a,<span class="keyword">const</span> Wint &amp;b)</span><br><span class="line">{</span><br><span class="line">    <span class="keyword">return</span> !(a!=b);</span><br><span class="line">}</span><br><span class="line"><span class="keyword">bool</span> <span class="keyword">operator</span>&lt;(<span class="keyword">const</span> Wint &amp;a,<span class="keyword">const</span> Wint &amp;b)</span><br><span class="line">{</span><br><span class="line">    <span class="keyword">if</span>(a.size()!=b.size())<span class="keyword">return</span> a.size()&lt;b.size();</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=a.size()<span class="number">-1</span>; i&gt;=<span class="number">0</span>; --i)</span><br><span class="line">        <span class="keyword">if</span>(a[i]!=b[i])<span class="keyword">return</span> a[i]&lt;b[i];</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">}</span><br><span class="line"><span class="keyword">bool</span> <span class="keyword">operator</span>&gt;(<span class="keyword">const</span> Wint &amp;a,<span class="keyword">const</span> Wint &amp;b)</span><br><span class="line">{</span><br><span class="line">    <span class="keyword">return</span> b&lt;a;</span><br><span class="line">}</span><br><span class="line"><span class="keyword">bool</span> <span class="keyword">operator</span>&lt;=(<span class="keyword">const</span> Wint &amp;a,<span class="keyword">const</span> Wint &amp;b)</span><br><span class="line">{</span><br><span class="line">    <span class="keyword">return</span> !(a&gt;b);</span><br><span class="line">}</span><br><span class="line"><span class="keyword">bool</span> <span class="keyword">operator</span>&gt;=(<span class="keyword">const</span> Wint &amp;a,<span class="keyword">const</span> Wint &amp;b)</span><br><span class="line">{</span><br><span class="line">    <span class="keyword">return</span> !(a&lt;b);</span><br><span class="line">}</span><br><span class="line">Wint&amp; <span class="keyword">operator</span>+=(Wint &amp;a,<span class="keyword">const</span> Wint &amp;b)</span><br><span class="line">{</span><br><span class="line">    <span class="keyword">if</span>(a.size()&lt;b.size())a.resize(b.size());</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>; i!=b.size(); ++i)a[i]+=b[i];</span><br><span class="line">    <span class="keyword">return</span> a.check();</span><br><span class="line">}</span><br><span class="line">Wint <span class="keyword">operator</span>+(Wint a,<span class="keyword">const</span> Wint &amp;b)</span><br><span class="line">{</span><br><span class="line">    <span class="keyword">return</span> a+=b;</span><br><span class="line">}</span><br><span class="line">Wint&amp; <span class="keyword">operator</span>-=(Wint &amp;a,Wint b)</span><br><span class="line">{</span><br><span class="line">    <span class="keyword">if</span>(a&lt;b)swap(a,b);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>; i!=b.size(); a[i]-=b[i],++i)</span><br><span class="line">        <span class="keyword">if</span>(a[i]&lt;b[i])</span><br><span class="line">        {</span><br><span class="line">            <span class="keyword">int</span> j=i+<span class="number">1</span>;</span><br><span class="line">            <span class="keyword">while</span>(!a[j])++j;</span><br><span class="line">            <span class="keyword">while</span>(j&gt;i)</span><br><span class="line">            {</span><br><span class="line">                --a[j];</span><br><span class="line">                a[--j]+=<span class="number">10</span>;</span><br><span class="line">            }</span><br><span class="line">        }</span><br><span class="line">    <span class="keyword">return</span> a.check();</span><br><span class="line">}</span><br><span class="line">Wint <span class="keyword">operator</span>-(Wint a,<span class="keyword">const</span> Wint &amp;b)</span><br><span class="line">{</span><br><span class="line">    <span class="keyword">return</span> a-=b;</span><br><span class="line">}</span><br><span class="line">Wint <span class="keyword">operator</span>*(<span class="keyword">const</span> Wint &amp;a,<span class="keyword">const</span> Wint &amp;b)</span><br><span class="line">{</span><br><span class="line">    Wint n;</span><br><span class="line">    n.assign(a.size()+b.size()<span class="number">-1</span>,<span class="number">0</span>);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>; i!=a.size(); ++i)</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">0</span>; j!=b.size(); ++j)</span><br><span class="line">            n[i+j]+=a[i]*b[j];</span><br><span class="line">    <span class="keyword">return</span> n.check();</span><br><span class="line">}</span><br><span class="line">Wint&amp; <span class="keyword">operator</span>*=(Wint &amp;a,<span class="keyword">const</span> Wint &amp;b)</span><br><span class="line">{</span><br><span class="line">    <span class="keyword">return</span> a=a*b;</span><br><span class="line">}</span><br><span class="line"><span class="function">Wint <span class="title">divmod</span><span class="params">(Wint &amp;a,<span class="keyword">const</span> Wint &amp;b)</span></span></span><br><span class="line"><span class="function"></span>{</span><br><span class="line">    Wint ans;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> t=a.size()-b.size(); a&gt;=b; --t)</span><br><span class="line">    {</span><br><span class="line">        Wint d;</span><br><span class="line">        d.assign(t+<span class="number">1</span>,<span class="number">0</span>);</span><br><span class="line">        d.back()=<span class="number">1</span>;</span><br><span class="line">        Wint c=b*d;</span><br><span class="line">        <span class="keyword">while</span>(a&gt;=c)</span><br><span class="line">        {</span><br><span class="line">            a-=c;</span><br><span class="line">            ans+=d;</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">}</span><br><span class="line">Wint <span class="keyword">operator</span>/(Wint a,<span class="keyword">const</span> Wint &amp;b)</span><br><span class="line">{</span><br><span class="line">    <span class="keyword">return</span> divmod(a,b);</span><br><span class="line">}</span><br><span class="line">Wint&amp; <span class="keyword">operator</span>/=(Wint &amp;a,<span class="keyword">const</span> Wint &amp;b)</span><br><span class="line">{</span><br><span class="line">    <span class="keyword">return</span> a=a/b;</span><br><span class="line">}</span><br><span class="line">Wint&amp; <span class="keyword">operator</span>%=(Wint &amp;a,<span class="keyword">const</span> Wint &amp;b)</span><br><span class="line">{</span><br><span class="line">    divmod(a,b);</span><br><span class="line">    <span class="keyword">return</span> a;</span><br><span class="line">}</span><br><span class="line">Wint <span class="keyword">operator</span>%(Wint a,<span class="keyword">const</span> Wint &amp;b)</span><br><span class="line">{</span><br><span class="line">    <span class="keyword">return</span> a%=b;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<h2 id="8-tips"><a href="#8-tips" class="headerlink" title="8. tips"></a>8. tips</h2><blockquote>
<p>唯一分解定理：n的因子个数Num(n) = (1 + a1) * (1 + a2) * … * (1 + an)<br>a &gt; b 且 gcd(a, b) == 1, 有$(gcd(a^n - b^n, a^m - b^m)) = a^{gcd(n, m)} - b^{gcd(n, m)}$<br>$\mu(n)$——莫比乌斯函数<br>$\varphi(n)$——欧拉函数。表示不大于n且与n互质的正整数个数，十分常见的数论函数。用数学式子表示即：$\varphi(n)=\sum_{i=1}^{n}[gcd(n,i) == 1]$<br>$d(n)$——约数个数。表示n的约数的个数。用式子表示为:$d(n)=\sum_{d|n}1$,也可以写作:$d(n)=\sum_{d=1}^{n}[d|n]$<br>$\sigma(n)$——约数和函数。即n的各个约数之和。表示为$\sigma(n)=\sum_{d|n}d=\sum_{d=1}^{n}[d|n] * d$  </p>
</blockquote>
<img src="/gallery/banzi/1.jpg" class="box px-0 py-0 ml-auto mr-auto" width="720" title="1-jpg" alt="1-jpg">
<img src="/gallery/banzi/2.jpg" class="box px-0 py-0 ml-auto mr-auto" width="720" title="2-jpg" alt="2-jpg">
<img src="/gallery/banzi/3.jpg" class="box px-0 py-0 ml-auto mr-auto" width="720" title="3-jpg" alt="3-jpg">
<img src="/gallery/banzi/4.jpg" class="box px-0 py-0 ml-auto mr-auto" width="720" title="4-jpg" alt="4-jpg">
<img src="/gallery/banzi/5.jpg" class="box px-0 py-0 ml-auto mr-auto" width="720" title="5-jpg" alt="5-jpg">
<img src="/gallery/banzi/6.jpg" class="box px-0 py-0 ml-auto mr-auto" width="720" title="6-jpg" alt="6-jpg">
<img src="/gallery/banzi/7.jpg" class="box px-0 py-0 ml-auto mr-auto" width="720" title="7-jpg" alt="7-jpg">
<img src="/gallery/banzi/8.jpg" class="box px-0 py-0 ml-auto mr-auto" width="720" title="8-jpg" alt="8-jpg">
<script>
        document.querySelectorAll('.not-gallery-item')
          .forEach(el => {
            if (!el.dataset.src) { return; }
            const img = document.createElement('img');
            img.style = 'display:none !important;';
            img.src = el.dataset.src;
            img.addEventListener('error', () => {
              img.remove();
              el.style.color = 'inherit';
              el.style.backgroundImage = 'none';
              el.style.background = 'none';
            });
            img.addEventListener('load', () => {
              img.remove();
            });
            document.body.appendChild(img);
          });
      </script></div><div class="article-licensing box"><div class="licensing-title"><p>板子</p><p><a href="https://exgod22356.github.com/Science/板子/">https://exgod22356.github.com/Science/板子/</a></p></div><div class="licensing-meta level is-mobile"><div class="level-left"><div class="level-item is-narrow"><div><h6>Author</h6><p>王钦砚</p></div></div><div class="level-item is-narrow"><div><h6>Posted on</h6><p>2019-08-28</p></div></div><div class="level-item is-narrow"><div><h6>Licensed under</h6><p><a class="icon" rel="noopener" target="_blank" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a><a class="" rel="noopener" target="_blank" title="CC BY-NC-SA 4.0" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a></p></div></div></div></div></div><div class="article-tags is-size-7 mb-4"><span class="mr-2">#</span><a class="link-muted mr-2" rel="tag" href="/tags/%E7%BC%96%E7%A8%8B/">编程</a><a class="link-muted mr-2" rel="tag" href="/tags/ACM/">ACM</a><a class="link-muted mr-2" rel="tag" href="/tags/%E6%A8%A1%E6%9D%BF/">模板</a></div><div class="sharethis-inline-share-buttons"></div><script src="//platform-api.sharethis.com/js/sharethis.js#property=5ab6f60ace89f00013641890&amp;product=inline-share-buttons" defer></script></article></div><!--!--><nav class="post-navigation mt-4 level is-mobile"><div class="level-start"><a class="article-nav-prev level level-item link-muted" href="/Science/%E6%B4%9B%E8%B0%B7p2357%E5%AE%88%E5%A2%93%E4%BA%BA%E9%A2%98%E8%A7%A3/"><i class="level-item fas fa-chevron-left"></i><span class="level-item">洛谷P2357守墓人题解</span></a></div><div class="level-end"><a class="article-nav-next level level-item link-muted" href="/Romance/to-his-coy-mistress/"><span class="level-item">To His Coy Mistress</span><i class="level-item fas fa-chevron-right"></i></a></div></nav><!--!--></div><div class="column column-left is-4-tablet is-4-desktop is-4-widescreen  order-1 is-sticky"><div class="card widget" data-type="profile"><div class="card-content"><nav class="level"><div class="level-item has-text-centered flex-shrink-1"><div><figure class="image is-128x128 mx-auto mb-2"><img class="avatar is-rounded" src="https://riyugo.com/i/2021/01/27/6nmiax.jpg" alt="王钦砚"></figure><p class="title is-size-4 is-block" style="line-height:inherit;">王钦砚</p><p class="is-size-6 is-block">Web Developer</p><p class="is-size-6 is-flex justify-content-center"><i class="fas fa-map-marker-alt mr-1"></i><span>Earth, Solar System</span></p></div></div></nav><nav class="level is-mobile"><div class="level-item has-text-centered is-marginless"><div><p class="heading">Posts</p><a href="/archives"><p class="title">35</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">Categories</p><a href="/categories"><p class="title">3</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">Tags</p><a href="/tags"><p class="title">24</p></a></div></div></nav><div class="level"><a class="level-item button is-primary is-rounded" href="https://github.com/exgod22356" target="_blank" rel="noopener">Follow</a></div><div class="level is-mobile"><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Github" href="https://github.com/exgod22356"><i class="fab fa-github"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Facebook" href="https://facebook.com"><i class="fab fa-facebook"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Twitter" href="https://twitter.com"><i class="fab fa-twitter"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Dribbble" href="https://dribbble.com"><i class="fab fa-dribbble"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="RSS" href="/"><i class="fas fa-rss"></i></a></div></div></div><div class="card widget" id="toc" data-type="toc"><div class="card-content"><div class="menu"><h3 class="menu-label">Catalogue</h3><ul class="menu-list"><li><a class="level is-mobile" href="#目录"><span class="level-left"><span class="level-item">1</span><span class="level-item">目录</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#1-数学"><span class="level-left"><span class="level-item">1.1</span><span class="level-item">1. 数学</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#1-1-gcd"><span class="level-left"><span class="level-item">1.1.1</span><span class="level-item">1.1. gcd</span></span></a></li><li><a class="level is-mobile" href="#1-2-exgcd"><span class="level-left"><span class="level-item">1.1.2</span><span class="level-item">1.2. exgcd</span></span></a></li><li><a class="level is-mobile" href="#1-3-求解线性同余方程"><span class="level-left"><span class="level-item">1.1.3</span><span class="level-item">1.3. 求解线性同余方程</span></span></a></li><li><a class="level is-mobile" href="#1-4-欧拉定理-扩展，-不适用于矩阵"><span class="level-left"><span class="level-item">1.1.4</span><span class="level-item">1.4. 欧拉定理(扩展， 不适用于矩阵)</span></span></a></li><li><a class="level is-mobile" href="#1-5-矩阵"><span class="level-left"><span class="level-item">1.1.5</span><span class="level-item">1.5. 矩阵</span></span></a></li><li><a class="level is-mobile" href="#1-6-广义斐波那契数列循环节"><span class="level-left"><span class="level-item">1.1.6</span><span class="level-item">1.6. 广义斐波那契数列循环节</span></span></a></li><li><a class="level is-mobile" href="#1-7-整除分块"><span class="level-left"><span class="level-item">1.1.7</span><span class="level-item">1.7. 整除分块</span></span></a></li><li><a class="level is-mobile" href="#1-8-莫比乌斯反演"><span class="level-left"><span class="level-item">1.1.8</span><span class="level-item">1.8. 莫比乌斯反演</span></span></a></li><li><a class="level is-mobile" href="#1-9-Lucas"><span class="level-left"><span class="level-item">1.1.9</span><span class="level-item">1.9. Lucas</span></span></a></li><li><a class="level is-mobile" href="#1-10-逆元"><span class="level-left"><span class="level-item">1.1.10</span><span class="level-item">1.10. 逆元</span></span></a></li><li><a class="level is-mobile" href="#1-11-BM算法"><span class="level-left"><span class="level-item">1.1.11</span><span class="level-item">1.11. BM算法</span></span></a></li><li><a class="level is-mobile" href="#1-12-二次剩余"><span class="level-left"><span class="level-item">1.1.12</span><span class="level-item">1.12. 二次剩余</span></span></a></li><li><a class="level is-mobile" href="#1-13-k次幂和"><span class="level-left"><span class="level-item">1.1.13</span><span class="level-item">1.13. k次幂和</span></span></a></li><li><a class="level is-mobile" href="#1-14-杜教筛"><span class="level-left"><span class="level-item">1.1.14</span><span class="level-item">1.14. 杜教筛</span></span></a></li></ul></li><li><a class="level is-mobile" href="#2-数据结构"><span class="level-left"><span class="level-item">1.2</span><span class="level-item">2. 数据结构</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#2-1-kd树"><span class="level-left"><span class="level-item">1.2.1</span><span class="level-item">2.1. kd树</span></span></a></li></ul></li><li><a class="level is-mobile" href="#3-dp"><span class="level-left"><span class="level-item">1.3</span><span class="level-item">3. dp</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#3-1-区间dp"><span class="level-left"><span class="level-item">1.3.1</span><span class="level-item">3.1. 区间dp</span></span></a></li><li><a class="level is-mobile" href="#3-2-状压dp"><span class="level-left"><span class="level-item">1.3.2</span><span class="level-item">3.2. 状压dp</span></span></a></li><li><a class="level is-mobile" href="#3-3-数位dp"><span class="level-left"><span class="level-item">1.3.3</span><span class="level-item">3.3. 数位dp</span></span></a></li></ul></li><li><a class="level is-mobile" href="#4-计算几何"><span class="level-left"><span class="level-item">1.4</span><span class="level-item">4. 计算几何</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#4-1-红书"><span class="level-left"><span class="level-item">1.4.1</span><span class="level-item">4.1. 红书</span></span></a></li><li><a class="level is-mobile" href="#4-2-三维向量旋转"><span class="level-left"><span class="level-item">1.4.2</span><span class="level-item">4.2. 三维向量旋转</span></span></a></li></ul></li><li><a class="level is-mobile" href="#5-博弈"><span class="level-left"><span class="level-item">1.5</span><span class="level-item">5. 博弈</span></span></a></li><li><a class="level is-mobile" href="#6-图论"><span class="level-left"><span class="level-item">1.6</span><span class="level-item">6. 图论</span></span></a></li><li><a class="level is-mobile" href="#7-黑科技"><span class="level-left"><span class="level-item">1.7</span><span class="level-item">7. 黑科技</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#7-1-高精"><span class="level-left"><span class="level-item">1.7.1</span><span class="level-item">7.1. 高精</span></span></a></li></ul></li><li><a class="level is-mobile" href="#8-tips"><span class="level-left"><span class="level-item">1.8</span><span class="level-item">8. tips</span></span></a></li></ul></li></ul></div></div><style>#toc .menu-list > li > a.is-active + .menu-list { display: block; }#toc .menu-list > li > a + .menu-list { display: none; }</style><script src="/js/toc.js" defer></script></div><div class="card widget" data-type="categories"><div class="card-content"><div class="menu"><h3 class="menu-label">Categories</h3><ul class="menu-list"><li><a class="level is-mobile" href="/categories/Ego/"><span class="level-start"><span class="level-item">Ego</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/Romance/"><span class="level-start"><span class="level-item">Romance</span></span><span class="level-end"><span class="level-item tag">7</span></span></a></li><li><a class="level is-mobile" href="/categories/Science/"><span class="level-start"><span class="level-item">Science</span></span><span class="level-end"><span class="level-item tag">27</span></span></a></li></ul></div></div></div><div class="card widget" data-type="tags"><div class="card-content"><div class="menu"><h3 class="menu-label">Tags</h3><div class="field is-grouped is-grouped-multiline"><div class="control"><a class="tags has-addons" href="/tags/ACM/"><span class="tag">ACM</span><span class="tag">5</span></a></div><div class="control"><a class="tags has-addons" href="/tags/C/"><span class="tag">C++</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/C-Primer/"><span class="tag">C++Primer</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/GO/"><span class="tag">GO</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Introduction/"><span class="tag">Introduction</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/JavaScript/"><span class="tag">JavaScript</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Linux/"><span class="tag">Linux</span><span class="tag">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/React/"><span class="tag">React</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/docker/"><span class="tag">docker</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/python/"><span class="tag">python</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E5%81%9A%E9%A2%98%E5%AE%B6/"><span class="tag">做题家</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E5%88%86%E5%B8%83%E5%BC%8F/"><span class="tag">分布式</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E5%9F%BA%E7%A1%80/"><span class="tag">基础</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E5%AE%89%E5%85%A8/"><span class="tag">安全</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E5%AE%B9%E5%99%A8%E5%8C%96/"><span class="tag">容器化</span><span class="tag">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E5%BC%80%E5%8F%91/"><span class="tag">开发</span><span class="tag">4</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E6%A8%A1%E6%9D%BF/"><span class="tag">模板</span><span class="tag">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E6%B1%87%E7%BC%96/"><span class="tag">汇编</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E7%AE%97%E6%B3%95/"><span class="tag">算法</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E7%BC%96%E7%A8%8B/"><span class="tag">编程</span><span class="tag">19</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E7%BC%96%E8%AF%91%E5%8E%9F%E7%90%86/"><span class="tag">编译原理</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E7%BD%91%E7%BB%9C/"><span class="tag">网络</span><span class="tag">4</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E8%AF%97%E5%8F%A5/"><span class="tag">诗句</span><span class="tag">7</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E9%9D%A2%E5%90%91%E9%9D%A2%E8%AF%95%E7%BC%96%E7%A8%8B/"><span class="tag">面向面试编程</span><span class="tag">1</span></a></div></div></div></div></div></div><!--!--></div></div></section><footer class="footer"><div class="container"><div class="level"><div class="level-start"><a class="footer-logo is-block mb-2" href="/"><img src="/img/logo.svg" alt="Icarus" height="28"></a><p class="is-size-7"><span>&copy; 2021 王钦砚</span>  Powered by <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a> &amp; <a href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank" rel="noopener">Icarus</a></p></div><div class="level-end"><div class="field has-addons"><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/exgod22356/exgod22356.github.io"><i class="fab fa-github"></i></a></p></div></div></div></div></footer><script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/min/moment-with-locales.min.js"></script><script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.min.js" async></script><script>moment.locale("en");</script><script>var IcarusThemeSettings = {
            article: {
                highlight: {
                    clipboard: true,
                    fold: 'unfolded'
                }
            }
        };</script><script src="/js/column.js"></script><script src="/js/animation.js"></script><a id="back-to-top" title="Back to top" href="javascript:;"><i class="fas fa-chevron-up"></i></a><script src="/js/back_to_top.js" defer></script><!--!--><!--!--><!--!--><script src="https://cdn.jsdelivr.net/npm/cookieconsent@3.1.1/build/cookieconsent.min.js" defer></script><script>window.addEventListener("load", () => {
      window.cookieconsent.initialise({
        type: "info",
        theme: "edgeless",
        static: false,
        position: "bottom-left",
        content: {
          message: "This website uses cookies to improve your experience.",
          dismiss: "Got it!",
          allow: "Allow cookies",
          deny: "Decline",
          link: "Learn more",
          policy: "Cookie Policy",
          href: "https://www.cookiesandyou.com/",
        },
        palette: {
          popup: {
            background: "#edeff5",
            text: "#838391"
          },
          button: {
            background: "#4b81e8"
          },
        },
      });
    });</script><script src="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/js/lightgallery.min.js" defer></script><script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/js/jquery.justifiedGallery.min.js" defer></script><script>window.addEventListener("load", () => {
            if (typeof $.fn.lightGallery === 'function') {
                $('.article').lightGallery({ selector: '.gallery-item' });
            }
            if (typeof $.fn.justifiedGallery === 'function') {
                if ($('.justified-gallery > p > .gallery-item').length) {
                    $('.justified-gallery > p > .gallery-item').unwrap();
                }
                $('.justified-gallery').justifiedGallery();
            }
        });</script><!--!--><div id="outdated"><h6>Your browser is out-of-date!</h6><p>Update your browser to view this website correctly.&amp;npsb;<a id="btnUpdateBrowser" href="http://outdatedbrowser.com/">Update my browser now </a></p><p class="last"><a href="#" id="btnCloseUpdateBrowser" title="Close">×</a></p></div><script src="https://cdn.jsdelivr.net/npm/outdatedbrowser@1.1.5/outdatedbrowser/outdatedbrowser.min.js" defer></script><script>window.addEventListener("load", function () {
            outdatedBrowser({
                bgColor: '#f25648',
                color: '#ffffff',
                lowerThan: 'object-fit' // display on IE11 or below
            });
        });</script><!--!--><!--!--><!--!--><script src="/js/main.js" defer></script><div class="searchbox"><div class="searchbox-container"><div class="searchbox-header"><div class="searchbox-input-container"><input class="searchbox-input" type="text" placeholder="Type something..."></div><a class="searchbox-close" href="javascript:;">×</a></div><div class="searchbox-body"></div></div></div><script src="/js/insight.js" defer></script><script>document.addEventListener('DOMContentLoaded', function () {
            loadInsight({"contentUrl":"/content.json"}, {"hint":"Type something...","untitled":"(Untitled)","posts":"Posts","pages":"Pages","categories":"Categories","tags":"Tags"});
        });</script><!-- hexo injector body_end start -->
    <script>
    (() => {
        function switchTab() {
            if (!location.hash) {
              return;
            }
            Array
                .from(document.querySelectorAll('.tab-content'))
                .forEach($tab => {
                    $tab.classList.add('is-hidden');
                });
            Array
                .from(document.querySelectorAll('.tabs li'))
                .forEach($tab => {
                    $tab.classList.remove('is-active');
                });
            const $activeTab = document.querySelector(location.hash);
            if ($activeTab) {
                $activeTab.classList.remove('is-hidden');
            }
            const $tabMenu = document.querySelector(`a[href="${location.hash}"]`);
            if ($tabMenu) {
                $tabMenu.parentElement.classList.add('is-active');
            }
        }
        switchTab();
        window.addEventListener('hashchange', switchTab, false);
    })();
    </script>
    <!-- hexo injector body_end end --></body></html>